const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UnifiedDashboardScreen-lzc6eomP.js","assets/react-core-FGHlRSau.js","assets/vendor-BX0gT1qP.js","assets/PlatformAdminScreen-BGLYfKt7.js","assets/module-screens-Dy02k3Q1.js","assets/google-ai-BrP-uSwO.js","assets/developer-tools-B-VjJpHg.js","assets/supabase-DKHGIEFa.js","assets/axios-ei4kQ0Q2.js","assets/icon-pack-tZfEXMDa.js","assets/monaco-Bh77eHRb.js","assets/SuperAdminDashboardScreen-BQXmOMkk.js","assets/QuickActionsWidget-CUrzXUss.js","assets/CompanyAdminDashboardScreen-D4R3urUu.js","assets/ProjectsListScreen-B9nmTZ3x.js","assets/ProjectHomeScreen-Q_8G9_7U.js","assets/MyDayScreen-5LFILwm1.js","assets/TaskList-BoJHYhCG.js","assets/TasksScreen-BYzL3o8n.js","assets/TaskDetailScreen-HRpYK5Pn.js","assets/PhotoLightbox-C62kCQiO.js","assets/NewTaskScreen-nnWgn9Wb.js","assets/DailyLogScreen-DvO3U8ow.js","assets/PhotoGalleryScreen-DQriBX3E.js","assets/RFIsScreen-GlqkADCR.js","assets/RFIDetailScreen-C9e7eIVt.js","assets/NewRFIScreen-B2hgCS4L.js","assets/CompanyAdminDashboard-5A7kbLDN.js","assets/CompanyAdminDashboardV2-CipYQH_v.js","assets/PunchListScreen-Dj-flUPd.js","assets/PunchListItemDetailScreen-BJw_jiOC.js","assets/NewPunchListItemScreen-mYfeZXAB.js","assets/DrawingsScreen-DliKzJUc.js","assets/PlansViewerScreen-KS0Rdc7V.js","assets/DayworkSheetsListScreen-BcA_QnGR.js","assets/DayworkSheetDetailScreen-Cm5MbGYj.js","assets/NewDayworkSheetScreen-f21VCGlE.js","assets/DocumentsScreen-dFp37QZN.js","assets/DeliveryScreen-hVIjAlEb.js","assets/DrawingComparisonScreen-CmpGJV0S.js","assets/MyTasksScreen-DX5yadxE.js","assets/PlaceholderToolScreen-BU8eglB7.js","assets/marketplace-9bItVkOZ.js","assets/MyApplicationsDesktop-DE6sxoLa.js","assets/Base44Clone-BYK7q9EG.js","assets/Base44Clone-b-Ug12NO.css","assets/AdminControlPanel-Bb8eo5nq.js","assets/EnhancedSuperAdminDashboard-CYMOePrk.js","assets/SuperAdminDashboardV2-CLLAhamE.js","assets/AdvancedMLDashboard-HFVzCm6B.js","assets/AnalyticsDashboardScreen-cazcvnzl.js","assets/AdvancedSearchScreen-teBg78DZ.js","assets/BulkOperationsScreen-BNjg_kTq.js","assets/CollaborationHubScreen-B1s5bpo7.js","assets/AdvancedAnalyticsScreen-BgNWy8iH.js","assets/AIRecommendationsScreen-CGbvc5-Q.js","assets/AIWorkflowScreen-ByqEVCLh.js","assets/SmartTaskAssignmentScreen-CxRYC0tS.js","assets/MobileToolsScreen-BbzVaoXk.js","assets/IntegrationsScreen-RREOXzQW.js","assets/BuildrInspiredDashboard-DDeqLJel.js","assets/EnhancedProjectManagement-eWwcQS7O.js","assets/EnhancedTeamCollaboration-D91-Wumr.js","assets/EnhancedFinancialTracking-CTbXviXQ.js","assets/EnhancedMobileExperience-BFykZBIp.js","assets/CommandCenter-B9ZdKdIo.js","assets/EnhancedTeamManagement-HBRD-33R.js","assets/BudgetForecastingDashboard-DhaThslM.js","assets/SafetyManagementDashboard-BjxwoHIn.js","assets/ResourceOptimizationDashboard-Be2N-i-b.js","assets/WeatherBasedScheduling-BLaBGwwl.js","assets/ChangeOrdersManagement-DaNe6nFD.js"])))=>i.map(i=>d[i]);
import{R as e,r as s,j as t,M as a,b as n}from"./react-core-FGHlRSau.js";import{c as r,_ as i}from"./supabase-DKHGIEFa.js";import{A as o,c as l,v as c,a as d,b as m,d as u,e as h,B as p,S as g,L as x,C as b,f,Q as j,g as y,D as _,T as w,h as v,W as N,i as k,X as E,H as S,j as A,s as D,M as L,k as I,l as T,m as P}from"./module-screens-Dy02k3Q1.js";import{l as C,s as R,r as z,g as O,a as M}from"./developer-tools-B-VjJpHg.js";import{aZ as V,ah as $}from"./icon-pack-tZfEXMDa.js";import{e as B}from"./vendor-BX0gT1qP.js";import"./google-ai-BrP-uSwO.js";import"./axios-ei4kQ0Q2.js";import"./monaco-Bh77eHRb.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();const F=e.memo(({onLoginSuccess:e})=>{const[a,n]=s.useState("adrian.stanca1@gmail.com"),[r,i]=s.useState("Cumparavinde1"),[m,u]=s.useState(""),[h,p]=s.useState(!1),[g,x]=s.useState(null),b=async e=>{if(R){u(""),x(e);try{const{error:s}=await R.auth.signInWithOAuth({provider:e,options:{redirectTo:window.location.origin}});s&&(u(`${e} login failed: ${s.message}`),x(null))}catch(s){u(s.message||`An error occurred during ${e} login.`),x(null)}}else u("OAuth authentication is not available. Supabase is not configured.")};return t.jsxs("form",{onSubmit:async s=>{s.preventDefault(),u(""),p(!0);const t=l(d(a),c(r));if(!t.isValid)return u(t.errors.join(". ")),void p(!1);try{const s=await C(a.trim(),r);e(s)}catch(n){n.message&&n.message.includes("Invalid credentials")?u("Invalid email or password. Please try again."):u(n.message||"Login failed. Please try again.")}finally{p(!1)}},className:"space-y-6",children:[m&&t.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 rounded-md",children:m}),t.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 border-l-4 border-purple-500 p-4 mb-4 rounded-r-lg",children:t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("svg",{className:"h-5 w-5 text-purple-500",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:t.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A.75.75 0 0010.747 15l.001-.001a.75.75 0 00.746-.894l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})})}),t.jsxs("div",{className:"ml-3 flex-1",children:[t.jsx("p",{className:"text-sm text-purple-800 font-bold mb-2",children:"ðŸ‘‘ Super Admin Access"}),t.jsxs("div",{className:"text-xs text-purple-700 space-y-1",children:[t.jsxs("div",{children:["Email: ",t.jsx("code",{className:"bg-purple-100 px-2 py-0.5 rounded font-mono",children:"adrian.stanca1@gmail.com"})]}),t.jsxs("div",{children:["Password: ",t.jsx("code",{className:"bg-purple-100 px-2 py-0.5 rounded font-mono",children:"Cumparavinde1"})]})]})]})]})}),t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border-l-4 border-blue-500 p-4 mb-4 rounded-r-lg",children:t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("svg",{className:"h-5 w-5 text-blue-500",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:t.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A.75.75 0 0010.747 15l.001-.001a.75.75 0 00.746-.894l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})})}),t.jsxs("div",{className:"ml-3 flex-1",children:[t.jsx("p",{className:"text-sm text-blue-800 font-bold mb-2",children:"ðŸ¢ Company Admin Access"}),t.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[t.jsxs("div",{children:["Email: ",t.jsx("code",{className:"bg-blue-100 px-2 py-0.5 rounded font-mono",children:"adrian@ascladdingltd.co.uk"})]}),t.jsxs("div",{children:["Password: ",t.jsx("code",{className:"bg-blue-100 px-2 py-0.5 rounded font-mono",children:"lolozania1"})]})]})]})]})}),t.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border-l-4 border-green-500 p-4 mb-4 rounded-r-lg",children:t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("svg",{className:"h-5 w-5 text-green-500",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:t.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A.75.75 0 0010.747 15l.001-.001a.75.75 0 00.746-.894l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})})}),t.jsxs("div",{className:"ml-3 flex-1",children:[t.jsx("p",{className:"text-sm text-green-800 font-bold mb-2",children:"ðŸ’» Developer Access"}),t.jsxs("div",{className:"text-xs text-green-700 space-y-1",children:[t.jsxs("div",{children:["Email: ",t.jsx("code",{className:"bg-green-100 px-2 py-0.5 rounded font-mono",children:"dev@constructco.com"})]}),t.jsxs("div",{children:["Password: ",t.jsx("code",{className:"bg-green-100 px-2 py-0.5 rounded font-mono",children:"password123"})]})]})]})]})}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"login-email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),t.jsx("div",{className:"mt-1",children:t.jsx("input",{id:"login-email",name:"email",type:"email",autoComplete:"email",required:!0,value:a,onChange:e=>n(e.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),t.jsx("div",{className:"mt-1",children:t.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:e=>i(e.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),t.jsx("div",{children:t.jsx("button",{type:"submit",disabled:h||null!==g,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:h?t.jsx(o,{className:"w-5 h-5 animate-spin"}):"Sign In"})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 flex items-center",children:t.jsx("div",{className:"w-full border-t border-gray-300"})}),t.jsx("div",{className:"relative flex justify-center text-sm",children:t.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx("button",{type:"button",onClick:()=>b("google"),disabled:h||null!==g,className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:"google"===g?t.jsx(o,{className:"w-5 h-5 animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[t.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),t.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google"]})}),t.jsx("button",{type:"button",onClick:()=>b("github"),disabled:h||null!==g,className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:"github"===g?t.jsx(o,{className:"w-5 h-5 animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})}),"GitHub"]})})]})]})});F.displayName="LoginForm";const q=e.memo(({onLoginSuccess:e})=>{const[a,n]=s.useState(""),[r,i]=s.useState(""),[h,p]=s.useState(""),[g,x]=s.useState(""),[b,f]=s.useState(""),[j,y]=s.useState(!1),[_,w]=s.useState(null),v=async e=>{if(R){f(""),w(e);try{const{data:s,error:t}=await R.auth.signInWithOAuth({provider:e,options:{redirectTo:`${window.location.origin}/#dashboard`}});t&&(f(`${e} signup failed: ${t.message}`),w(null))}catch(s){f(s.message||`An error occurred during ${e} signup.`),w(null)}}else f("OAuth authentication is not available. Supabase is not configured.")};return t.jsxs("form",{onSubmit:async s=>{s.preventDefault(),f(""),y(!0);const t=l(u(a),d(r),m(h),c(g));if(!t.isValid)return f(t.errors.join(". ")),void y(!1);try{const s=await z(r.trim(),g,a.trim(),h.trim());e(s)}catch(n){f(n.message||"Registration failed. Please try again.")}finally{y(!1)}},className:"space-y-4",children:[b&&t.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 rounded-md",children:b}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),t.jsx("input",{id:"name",type:"text",required:!0,value:a,onChange:e=>n(e.target.value),className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"companyName",className:"block text-sm font-medium text-gray-700",children:"Company Name"}),t.jsx("input",{id:"companyName",type:"text",required:!0,value:h,onChange:e=>p(e.target.value),className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"reg-email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),t.jsx("input",{id:"reg-email",name:"email",type:"email",required:!0,value:r,onChange:e=>i(e.target.value),className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"reg-password",className:"block text-sm font-medium text-gray-700",children:"Password"}),t.jsx("input",{id:"reg-password",type:"password",required:!0,value:g,onChange:e=>x(e.target.value),className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"6 characters minimum"})]}),t.jsx("div",{children:t.jsx("button",{type:"submit",disabled:j||null!==_,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:j?t.jsx(o,{className:"w-5 h-5 animate-spin"}):"Create Account"})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 flex items-center",children:t.jsx("div",{className:"w-full border-t border-gray-300"})}),t.jsx("div",{className:"relative flex justify-center text-sm",children:t.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or sign up with"})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx("button",{type:"button",onClick:()=>v("google"),disabled:j||null!==_,className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:"google"===_?t.jsx(o,{className:"w-5 h-5 animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[t.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),t.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google"]})}),t.jsx("button",{type:"button",onClick:()=>v("github"),disabled:j||null!==_,className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:"github"===_?t.jsx(o,{className:"w-5 h-5 animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})}),"GitHub"]})})]})]})});q.displayName="RegisterForm";const U=({onLoginSuccess:e})=>{const[a,n]=s.useState(!0);return t.jsx("div",{className:"w-full max-w-md mx-auto",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-2",children:a?"Welcome Back":"Create Account"}),t.jsx("p",{className:"text-center text-gray-500 mb-8",children:a?"Sign in to continue to ConstructAI":"Get started with your new account"}),a?t.jsx(F,{onLoginSuccess:e}):t.jsx(q,{onLoginSuccess:e}),t.jsxs("p",{className:"text-center text-sm text-gray-600 mt-8",children:[a?"Don't have an account?":"Already have an account?",t.jsx("button",{onClick:()=>n(!a),className:"font-semibold text-blue-600 hover:text-blue-500 ml-1",children:a?"Sign Up":"Sign In"})]})]})})},W=({sidebar:e,children:s,floatingMenu:a})=>t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx("aside",{className:"w-64 bg-slate-800 text-white fixed h-full z-30",children:e}),t.jsxs("div",{className:"flex-1 ml-64 flex flex-col",children:[a,t.jsx("div",{className:"flex-grow",children:s})]})]}),H=e=>s.useMemo(()=>({can:(s,t)=>!!e&&h(e.role,s,t)}),[e]),K=({label:e,icon:s,onClick:a})=>t.jsx("li",{children:t.jsxs("button",{onClick:a,className:"w-full flex items-center p-3 text-sm text-slate-300 rounded-lg hover:bg-slate-700 transition-colors",children:[t.jsx(s,{className:"w-6 h-6 mr-3 text-slate-400"}),t.jsx("span",{children:e})]})}),G=()=>{const[e,a]=s.useState(new Date),[n,r]=s.useState(null);s.useEffect(()=>{const e=setInterval(()=>a(new Date),1e3);return()=>clearInterval(e)},[]),s.useEffect(()=>{setTimeout(()=>{r({temp:"15Â°C",condition:"Sunny",icon:g})},1500)},[]);const i=e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),o=e.toLocaleDateString([],{weekday:"long",day:"numeric",month:"long"}),l=n?.icon;return t.jsxs("div",{className:"mb-6 py-4 text-center border-y border-slate-700",children:[t.jsx("div",{className:"text-4xl font-bold text-white tracking-wider",children:i}),t.jsx("div",{className:"text-sm text-slate-400 mt-1",children:o}),t.jsx("div",{className:"flex items-center justify-center gap-2 mt-4 text-slate-300",children:n&&l?t.jsxs(t.Fragment,{children:[t.jsx(l,{className:"w-6 h-6 text-yellow-400"}),t.jsxs("span",{className:"font-semibold",children:[n.temp,", ",n.condition]})]}):t.jsx("div",{className:"h-6 flex items-center",children:t.jsx("span",{className:"text-xs text-slate-500",children:"Loading weather..."})})})]})},J=({project:e,navigateTo:s,navigateToModule:a,goHome:n,currentUser:r,onLogout:i})=>{const{can:l}=H(r),c="developer"===r?.role,d="super_admin"===r?.role,m="company_admin"===r?.role,u="super_admin"===r?.role||c,h=[{label:"My Projects",screen:"projects",icon:p,permission:{subject:"task",action:"read"}},{label:"My Day",screen:"my-day",icon:g,permission:{subject:"task",action:"read"}},{label:"Tasks",screen:"tasks",icon:x,permission:{subject:"task",action:"read"}},{label:"Daily Logs",screen:"daily-log",icon:b,permission:{subject:"dailyLog",action:"read"}},{label:"Photos",screen:"photos",icon:f,permission:{subject:"photo",action:"read"}},{label:"RFIs",screen:"rfis",icon:j,permission:{subject:"rfi",action:"read"}},{label:"Punch List",screen:"punch-list",icon:y,permission:{subject:"punchListItem",action:"read"}},{label:"Drawings",screen:"drawings",icon:_,permission:{subject:"drawing",action:"read"}},{label:"Daywork Sheets",screen:"daywork-sheets",icon:w,permission:{subject:"dayworkSheet",action:"read"}},{label:"Documents",screen:"documents",icon:v,permission:{subject:"document",action:"read"}}],E=u?[{label:u?"SDK Developer":"SDK Demo",screen:"sdk-developer",icon:()=>t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4h16v16H4z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 8h8v8H8z"})]}),permission:{subject:"task",action:"read"},isModule:!0}]:[],S=[{label:"Developer Console",screen:"developer-console",icon:N,isModule:!0},{label:"Automation Studio",screen:"automation-studio",icon:o,isModule:!0},{label:"SDK Workspace",screen:"sdk-developer",icon:_,isModule:!0},{label:"AI Tools",screen:"ai-tools",icon:g,isModule:!0},{label:"Marketplace",screen:"ai-agents-marketplace",icon:w,isModule:!0}],A=m?[{label:"Company Dashboard",screen:"company-admin-dashboard",icon:p,isModule:!0},{label:"ðŸŽ¯ Command Center",screen:"command-center",icon:N,isModule:!0},{label:"Team Management",screen:"team-management",icon:p,isModule:!0},{label:"Budget Forecasting",screen:"budget-forecasting",icon:v,isModule:!0},{label:"Safety Dashboard",screen:"safety-management",icon:y,isModule:!0},{label:"Resource Optimization",screen:"resource-optimization",icon:w,isModule:!0},{label:"â˜ï¸ Weather Scheduling",screen:"weather-scheduling",icon:g,isModule:!0},{label:"Change Orders",screen:"change-orders",icon:_,isModule:!0},{label:"Innovation Sandbox",screen:"developer-dashboard",icon:N,isModule:!0}]:[],D=[{label:"Super Admin Home",screen:"super-admin-dashboard",icon:y,isModule:!0},{label:"Platform Admin",screen:"platform-admin",icon:v,isModule:!0}],L=(!!e.id?h.filter(e=>"projects"!==e.screen):[h.find(e=>"projects"===e.screen)]).filter(e=>l(e.permission.action,e.permission.subject)),I=c?S:d?D:[...L,...A,...E];return t.jsxs("div",{className:"flex flex-col h-full p-4",children:[t.jsx("div",{className:"mb-6",children:t.jsxs("button",{onClick:n,className:"block text-left",children:[t.jsx("h1",{className:"text-xl font-bold text-white",children:c?"Developer Tenant":d?"Super Admin":m?"Company Admin":e.name}),t.jsx("p",{className:"text-sm text-slate-400",children:c?r.companyId:d?r.email:m?r.companyId:e.location})]})}),t.jsx(G,{}),t.jsx("nav",{className:"flex-grow",children:t.jsx("ul",{className:"space-y-1",children:I.map(e=>{const n=("projects"===e.screen||e.isModule)&&a?a:s;return t.jsx(K,{label:e.label,icon:e.icon,onClick:()=>n(e.screen)},e.screen)})})}),t.jsxs("div",{className:"mt-auto pt-4 border-t border-slate-700",children:[t.jsxs("div",{className:"text-center text-slate-300 p-3 mb-2",children:[t.jsx("p",{className:"font-semibold",children:r.name}),t.jsx("p",{className:"text-xs text-slate-400 capitalize",children:r.role.replace("_"," ")})]}),t.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center p-3 text-sm text-slate-300 rounded-lg hover:bg-slate-700 transition-colors",children:[t.jsx(k,{className:"w-5 h-5 mr-2"}),t.jsx("span",{children:"Logout"})]})]})]})},Q={id:"proj-1",companyId:"comp-1",name:"Metropolis Grand Tower",location:"123 Main St, Metropolis, USA",image:"https://picsum.photos/seed/project/800/600",description:"A 50-story mixed-use skyscraper featuring retail, office, and residential units. Currently in the structural steel phase.",contacts:[{role:"Project Manager",name:"Jane PM"},{role:"Superintendent",name:"Mike Superintendent"},{role:"Lead Foreman",name:"John Foreman"}],snapshot:{openRFIs:3,overdueTasks:1,pendingTMTickets:5,aiRiskLevel:"Low"}},X=({isOpen:e,isLoading:a,suggestion:n,onClose:r,onAction:i,currentUser:l})=>{const[c,d]=s.useState(null);if(!e)return null;const m=async e=>{!c&&n&&(d(e),await D(n,e,l))};return t.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:r,children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg",onClick:e=>e.stopPropagation(),children:[t.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(N,{className:"w-6 h-6 text-purple-600"}),t.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"AI Suggested Action"})]}),t.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100",children:t.jsx(E,{className:"w-6 h-6 text-gray-600"})})]}),t.jsxs("div",{className:"p-6 min-h-[150px] flex items-center justify-center",children:[a&&t.jsxs("div",{className:"text-center text-gray-600",children:[t.jsx(o,{className:"w-8 h-8 animate-spin mx-auto mb-2"}),t.jsx("p",{children:"Analyzing your workload..."})]}),!a&&n&&t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:n.title}),t.jsx("p",{className:"text-md text-gray-600 mt-2",children:n.reason})]}),!a&&!n&&t.jsx("div",{className:"text-center text-gray-600",children:t.jsx("p",{children:"Could not generate a suggestion at this time."})})]}),t.jsxs("footer",{className:"p-4 bg-gray-50 border-t flex justify-between items-center gap-3",children:[t.jsx("div",{className:"flex items-center gap-2",children:c?t.jsx("p",{className:"text-sm text-green-700 font-semibold p-2",children:"Thank you for your feedback!"}):t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>m("up"),disabled:a||!n,className:"p-2 rounded-full text-gray-500 hover:bg-green-100 hover:text-green-600 disabled:opacity-50 disabled:hover:bg-transparent",title:"Good suggestion",children:t.jsx(S,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>m("down"),disabled:a||!n,className:"p-2 rounded-full text-gray-500 hover:bg-red-100 hover:text-red-600 disabled:opacity-50 disabled:hover:bg-transparent",title:"Bad suggestion",children:t.jsx(A,{className:"w-5 h-5"})})]})}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-200 rounded font-semibold",children:"Cancel"}),t.jsx("button",{onClick:()=>{n&&i(n.action.link)},disabled:a||!n,className:"px-4 py-2 bg-blue-600 text-white rounded font-semibold disabled:bg-gray-400 disabled:cursor-not-allowed",children:a?"Loading...":n?.action.label||"Action"})]})]})]})})},Y=({onSelectProject:e,onClose:a,title:n,currentUser:r})=>{const[i,o]=s.useState([]),[l,c]=s.useState(!0);s.useEffect(()=>{(async()=>{c(!0);const e=await I(r);o(e),c(!1)})()},[r]);return t.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:a,children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl",onClick:e=>e.stopPropagation(),children:[t.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-800",children:n}),t.jsx("button",{onClick:a,className:"p-2 rounded-full hover:bg-gray-100",children:t.jsx(E,{className:"w-6 h-6 text-gray-600"})})]}),t.jsx("div",{className:"p-4 max-h-[70vh] overflow-y-auto",children:l?t.jsx("p",{className:"text-center text-gray-500 py-8",children:"Loading projects..."}):t.jsx("ul",{className:"space-y-2",children:i.map(s=>t.jsx("li",{children:t.jsxs("button",{onClick:()=>{return t=s.id,void e(t);var t},className:"w-full flex items-center gap-4 p-3 rounded-lg text-left transition-colors hover:bg-gray-100",children:[t.jsx("img",{src:s.image,alt:s.name,className:"w-16 h-12 object-cover rounded-md flex-shrink-0"}),t.jsxs("div",{className:"flex-grow",children:[t.jsx("p",{className:"font-bold",children:s.name}),t.jsxs("p",{className:"text-sm flex items-center text-gray-500",children:[t.jsx(L,{className:"w-4 h-4 mr-1.5"}),s.location]})]})]})},s.id))})})]})})},Z=[{label:"My Applications",screen:"my-apps-desktop",permission:{subject:"user",action:"read"}},{label:"Accounting",screen:"accounting",permission:{subject:"accounting",action:"read"}},{label:"AI Features",children:[{label:"AI Recommendations",screen:"ai-recommendations",permission:{subject:"user",action:"read"}},{label:"AI Workflow Automation",screen:"ai-workflow",permission:{subject:"user",action:"read"}},{label:"Smart Task Assignment",screen:"smart-task-assignment",permission:{subject:"task",action:"update"}}]},{label:"Mobile & Integration",children:[{label:"Mobile Tools",screen:"mobile-tools",permission:{subject:"user",action:"read"}},{label:"Third-Party Integrations",screen:"integrations",permission:{subject:"user",action:"read"}}]},{label:"Advanced Features",children:[{label:"Advanced Search",screen:"advanced-search",permission:{subject:"user",action:"read"}},{label:"Bulk Operations",screen:"bulk-operations",permission:{subject:"task",action:"update"}},{label:"Collaboration Hub",screen:"collaboration-hub",permission:{subject:"user",action:"read"}},{label:"Advanced Analytics",screen:"advanced-analytics",permission:{subject:"user",action:"read"}}]},{label:"Buildr-Inspired Features",children:[{label:"Enhanced Dashboard",screen:"buildr-dashboard",permission:{subject:"user",action:"read"}},{label:"Enhanced Project Management",screen:"enhanced-project-management",permission:{subject:"task",action:"read"}},{label:"Enhanced Team Collaboration",screen:"enhanced-team-collaboration",permission:{subject:"user",action:"read"}},{label:"Enhanced Financial Tracking",screen:"enhanced-financial-tracking",permission:{subject:"accounting",action:"read"}},{label:"Enhanced Mobile Experience",screen:"enhanced-mobile-experience",permission:{subject:"user",action:"read"}}]},{label:"AI Tools",children:[{label:"AI Agents Marketplace",screen:"ai-agents-marketplace",permission:{subject:"user",action:"read"}},{label:"AI Tools Suite",screen:"ai-tools",permission:{subject:"task",action:"read"}},{label:"My Application Desktop",screen:"myapplicationdesktop",permission:{subject:"user",action:"read"}}]},{label:"Document Management",children:[{label:"All Documents",screen:"document-management",permission:{subject:"document",action:"read"}},{label:"Drawings",screen:"drawings",permission:{subject:"drawing",action:"read"},requiresProjectContext:!0},{label:"Photo Gallery",screen:"photos",permission:{subject:"photo",action:"read"},requiresProjectContext:!0},{label:"Reports",screen:"documents",permission:{subject:"document",action:"read"},requiresProjectContext:!0}]},{label:"Time Tracking",screen:"time-tracking",permission:{subject:"timeEntry",action:"read"}},{label:"Project Operations",screen:"project-operations"},{label:"Financial Management",screen:"financial-management",permission:{subject:"accounting",action:"read"}},{label:"Business Development",screen:"business-development"},{label:"Platform Admin",screen:"platform-admin",permission:{subject:"user",action:"read"}}],ee=r("https://zpbuvuxpfemldsknerew.supabase.co","sb_publishable_LJlZdJB0JylgynMF8MCtQw_m0sKjIK3",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},db:{schema:"public"},global:{headers:{"x-application-name":"CortexBuild"}}});new class{constructor(){this.permission="default",this.swRegistration=null,this.vapidPublicKey=null,this.initialize()}async initialize(){if("Notification"in window){if(this.permission=Notification.permission,"permissions"in navigator)try{(await navigator.permissions.query({name:"notifications"})).onchange=()=>{this.permission=Notification.permission}}catch(e){}this.registerServiceWorker()}}async registerServiceWorker(){if("serviceWorker"in navigator)try{this.swRegistration=await navigator.serviceWorker.register("/sw.js")}catch(e){}}async requestPermission(){if(!("Notification"in window))return!1;if("granted"===this.permission)return!0;if("denied"===this.permission)return!1;try{const e=await Notification.requestPermission();return this.permission=e,"granted"===e?(await this.updatePushEnabled(!0),!0):(await this.updatePushEnabled(!1),!1)}catch(e){return!1}}isSupported(){return"Notification"in window}getPermissionState(){return{granted:"granted"===this.permission,denied:"denied"===this.permission,default:"default"===this.permission,state:this.permission}}async show(e){if("granted"!==this.permission)return null;try{const s=new Notification(e.title,{body:e.body,icon:e.icon||"/logo.png",badge:e.badge||"/badge.png",image:e.image,data:e.data,actions:e.actions,requireInteraction:e.requireInteraction||!1,silent:e.silent||!1,tag:e.tag||"cortexbuild-notification",timestamp:e.timestamp||Date.now(),renotify:!0});return s.onclick=t=>{t.preventDefault(),window.focus(),e.data?.action_url?window.location.href=e.data.action_url:e.data?.notification_id&&this.markNotificationAsRead(e.data.notification_id),s.close()},s.onclose=()=>{e.data?.notification_id&&this.markNotificationAsDismissed(e.data.notification_id)},e.requireInteraction||setTimeout(()=>{s.close()},5e3),s.tag||"notification"}catch(s){return null}}async showFromNotification(e){const s=await this.getUserPreferences();if(!s?.push_enabled)return null;const t=s.categories?.[e.category];if(!t?.push)return null;if(s.quiet_hours_enabled&&this.isInQuietHours(s))return null;if(await this.isRateLimited(s))return null;const a={title:e.title,body:e.message,icon:"/logo.png",badge:"/badge.png",data:{notification_id:e.id,action_url:e.action_url,category:e.category,priority:e.priority},tag:`notification-${e.id}`,requireInteraction:"urgent"===e.priority||"high"===e.priority,timestamp:new Date(e.created_at).getTime()};return"urgent"===e.priority&&(a.silent=!1,a.requireInteraction=!0),this.show(a)}async updatePushEnabled(e){try{const{data:{user:s}}=await ee.auth.getUser();if(!s)return;await ee.from("notification_preferences").upsert({user_id:s.id,push_enabled:e,updated_at:(new Date).toISOString()})}catch(s){}}async getUserPreferences(){try{const{data:{user:e}}=await ee.auth.getUser();if(!e)return null;const{data:s,error:t}=await ee.from("notification_preferences").select("*").eq("user_id",e.id).single();if(t&&"PGRST116"!==t.code)throw t;return s}catch(e){return null}}isInQuietHours(e){if(!e.quiet_hours_enabled)return!1;const s=new Date,t=100*s.getHours()+s.getMinutes(),a=parseInt(e.quiet_hours_start.replace(":","")),n=parseInt(e.quiet_hours_end.replace(":",""));return a<=n?t>=a&&t<=n:t>=a||t<=n}async isRateLimited(e){if(!e.max_notifications_per_hour)return!1;try{const{data:{user:s}}=await ee.auth.getUser();if(!s)return!1;const t=new Date(Date.now()-36e5).toISOString(),{count:a,error:n}=await ee.from("notification_channels").select("*",{count:"exact",head:!0}).eq("channel","push").eq("status","sent").gte("sent_at",t);return!n&&(a||0)>=e.max_notifications_per_hour}catch(s){return!1}}async markNotificationAsRead(e){try{const{data:{user:s}}=await ee.auth.getUser();if(!s)return;await ee.from("notifications").update({read:!0,clicked_at:(new Date).toISOString()}).eq("id",e).eq("user_id",s.id)}catch(s){}}async markNotificationAsDismissed(e){try{const{data:{user:s}}=await ee.auth.getUser();if(!s)return;await ee.from("notifications").update({dismissed_at:(new Date).toISOString()}).eq("id",e).eq("user_id",s.id)}catch(s){}}async updateDeliveryStatus(e,s,t){try{const{data:{user:a}}=await ee.auth.getUser();if(!a)return;const n={status:s,updated_at:(new Date).toISOString()};"sent"===s?n.sent_at=(new Date).toISOString():"delivered"===s?n.delivered_at=(new Date).toISOString():"failed"===s&&(n.failed_at=(new Date).toISOString(),t&&(n.error_message=t)),await ee.from("notification_channels").update(n).eq("notification_id",e).eq("channel","push")}catch(a){}}async getNotificationHistory(e=50){try{const{data:{user:s}}=await ee.auth.getUser();if(!s)return[];const{data:t,error:a}=await ee.from("notifications").select("*").eq("user_id",s.id).order("created_at",{ascending:!1}).limit(e);if(a)throw a;return t||[]}catch(s){return[]}}async clearAll(){this.permission}async test(){return!!(await this.requestPermission())&&!!(await this.show({title:"Test Notification",body:"This is a test notification from CortexBuild",icon:"/logo.png",tag:"test-notification"}))}setupVAPID(e){this.vapidPublicKey=e}async subscribeToWebPush(){if(!this.swRegistration||!this.vapidPublicKey)return null;try{return await this.swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.vapidPublicKey})}catch(e){return null}}async unsubscribeFromWebPush(){if(this.swRegistration)try{const e=await this.swRegistration.pushManager.getSubscription();e&&await e.unsubscribe()}catch(e){}}};const se=s.createContext(void 0);function te(){const e=s.useContext(se);if(void 0===e)throw new Error("useNotifications must be used within a NotificationProvider");return e}const ae=({userId:e,onOpenNotifications:a,showUnreadCount:n=!0,maxCount:r=99,className:i=""})=>{const{unreadCount:o,loading:l,error:c,isSubscribed:d}=te(),[m,u]=s.useState(!1),[h,p]=s.useState(!1),[g,x]=s.useState(0);s.useEffect(()=>{if(o>g&&g>0){p(!0);const e=setTimeout(()=>p(!1),3e3);return()=>clearTimeout(e)}x(o)},[o,g]);const b=()=>{a()},f=o>0?V:$,j=o>r?`${r}+`:o.toString(),y=`\n    relative p-2 text-gray-600 hover:text-gray-900 transition-all duration-200\n    ${h?"animate-bounce":""}\n    ${l?"opacity-50":""}\n    ${c?"text-red-500":""}\n    ${i}\n  `,_=`\n    absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center \n    rounded-full text-xs font-bold text-white transition-all duration-200\n    ${0===o?"bg-gray-500":"bg-red-500"}\n    ${h?"animate-pulse scale-110":""}\n    ${n&&0!==o?"":"hidden"}\n  `,w=`\n    absolute top-1 right-1 h-2 w-2 rounded-full bg-red-500\n    ${d?"animate-pulse":""}\n    ${o>0?"hidden":""}\n  `;return t.jsxs("button",{onClick:b,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),b())},className:y,"aria-label":"Notifications "+(o>0?`(${o} unread)`:"(no unread)"),"aria-expanded":!1,role:"button",tabIndex:0,children:[t.jsx(f,{className:"h-6 w-6 transition-colors duration-200 "+(m?"text-blue-600":"")}),t.jsx("div",{className:w,title:d?"Connected":"Disconnected"}),n&&o>0&&t.jsx("span",{className:_,children:j}),m&&t.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded whitespace-nowrap z-50",children:[l?"Loading...":c?"Error loading notifications":`${o} unread notifications`,t.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]})},ne=({currentUser:e,navigateToModule:a,openProjectSelector:n,onDeepLink:r})=>{const[i,o]=s.useState(null),l=s.useRef(null),{can:c}=H(e),d=e=>e.children?e.children.some(d):!e.permission||c(e.permission.action,e.permission.subject),m=("developer"===e.role?[{label:"Developer Console",screen:"developer-console"},{label:"SDK Workspace",screen:"sdk-developer"},{label:"Marketplace",screen:"ai-agents-marketplace"}]:"super_admin"===e.role?[{label:"Super Admin Dashboard",screen:"super-admin-dashboard"},{label:"Platform Admin",screen:"platform-admin"}]:"company_admin"===e.role?[{label:"Developer Tools",screen:"developer-dashboard"},{label:"SDK Workspace",screen:"sdk-developer"}]:Z).filter(d);s.useEffect(()=>{const e=e=>{l.current&&!l.current.contains(e.target)&&o(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const u=e=>{e.screen&&(o(null),e.requiresProjectContext?n(`Select a project for ${e.label}`,s=>{r(s,e.screen,{})}):a(e.screen))};return t.jsx("nav",{ref:l,className:"sticky top-0 bg-white/80 backdrop-blur-lg shadow-sm z-20 border-b border-gray-200",children:t.jsx("div",{className:"container mx-auto px-6",children:t.jsxs("div",{className:"flex items-center justify-between h-14",children:[t.jsx("div",{className:"flex items-center",children:m.map(e=>t.jsxs("div",{className:"relative",children:[e.children?t.jsxs("button",{onClick:()=>{return s=e.label,void o(e=>e===s?null:s);var s},className:"flex items-center gap-1 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-100 rounded-md",children:[e.label,t.jsx(T,{className:"w-4 h-4 transition-transform "+(i===e.label?"rotate-180":"")})]}):t.jsx("button",{onClick:()=>u(e),className:"px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-100 rounded-md",children:e.label}),e.children&&i===e.label&&t.jsx("div",{className:"absolute left-0 mt-2 w-56 origin-top-left bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none py-1",children:e.children.filter(d).map(e=>t.jsx("button",{onClick:()=>u(e),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:e.label},e.label))})]},e.label))}),t.jsx("div",{className:"flex items-center gap-4",children:t.jsx(ae,{userId:e.id,onOpenNotifications:()=>{}})})]})})})},re=({toast:e,onClose:a})=>{const[n,r]=s.useState(!1);s.useEffect(()=>{const s=setTimeout(()=>r(!0),10),t=setTimeout(()=>{i()},e.duration||5e3);return()=>{clearTimeout(s),clearTimeout(t)}},[e.duration]);const i=()=>{r(!1),setTimeout(()=>a(e.id),300)};return t.jsx("div",{className:`max-w-sm w-full shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 transform transition-all duration-300 ${n?"translate-y-0 opacity-100":"-translate-y-2 opacity-0"} ${(()=>{switch(e.type){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-yellow-50 border-yellow-200";case"info":return"bg-blue-50 border-blue-200"}})()}`,children:t.jsx("div",{className:"p-4",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx("div",{className:"flex-shrink-0",children:(()=>{switch(e.type){case"success":return t.jsx("svg",{className:"w-6 h-6 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"error":return t.jsx("svg",{className:"w-6 h-6 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return t.jsx("svg",{className:"w-6 h-6 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});case"info":return t.jsx("svg",{className:"w-6 h-6 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}})()}),t.jsxs("div",{className:"ml-3 w-0 flex-1 pt-0.5",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.title}),e.message&&t.jsx("p",{className:"mt-1 text-sm text-gray-500",children:e.message})]}),t.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:t.jsxs("button",{className:"inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded-md p-1",onClick:i,children:[t.jsx("span",{className:"sr-only",children:"Close"}),t.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:t.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]})})})},ie=({toasts:e,onRemoveToast:s})=>t.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(e=>t.jsx(re,{toast:e,onClose:s},e.id))});const oe=new class{constructor(){this.logs=[],this.maxLogs=1e3,this.sessionId=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}createLogEntry(e,s,t,a){return{timestamp:(new Date).toISOString(),level:e,message:s,context:t,userId:a,sessionId:this.sessionId}}log(e,s,t,a){const n=this.createLogEntry(e,s,t,a);this.logs.push(n),this.logs.length>this.maxLogs&&this.logs.shift();n.timestamp,e.toUpperCase(),this.sessionId;this.sendToLoggingService(n)}debug(e,s,t){this.log("debug",e,s,t)}info(e,s,t){this.log("info",e,s,t)}warn(e,s,t){this.log("warn",e,s,t)}error(e,s,t){this.log("error",e,s,t)}logUserAction(e,s,t){this.info(`User Action: ${e}`,s,t)}logApiCall(e,s,t,a,n){const r=t&&t>=400?"warn":"info";this.log(r,`API Call: ${s} ${e}`,{statusCode:t,duration:a?`${a}ms`:void 0},n)}logError(e,s,t){this.error(`Error: ${e.message}`,{stack:e.stack,...s},t)}logPerformance(e,s,t,a){const n=s>5e3?"warn":"debug";this.log(n,`Performance: ${e}`,{duration:`${s}ms`,...t},a)}getRecentLogs(e=100){return this.logs.slice(-e)}getLogsByLevel(e){return this.logs.filter(s=>s.level===e)}getLogsByUser(e){return this.logs.filter(s=>s.userId===e)}clearLogs(){this.logs=[]}exportLogs(){return JSON.stringify(this.logs,null,2)}sendToLoggingService(e){}},le=({role:e,content:s,timestamp:n,isLoading:r=!1})=>{const i="user"===e;return t.jsx("div",{className:`flex ${i?"justify-end":"justify-start"} mb-4`,children:t.jsxs("div",{className:"flex gap-3 max-w-[80%] "+(i?"flex-row-reverse":"flex-row"),children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold "+(i?"bg-blue-600 text-white":"bg-gradient-to-br from-purple-600 to-blue-600 text-white"),children:i?"ðŸ‘¤":"ðŸ¤–"}),t.jsxs("div",{className:"flex flex-col "+(i?"items-end":"items-start"),children:[t.jsx("div",{className:"rounded-2xl px-4 py-3 "+(i?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"),children:r?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"flex gap-1",children:[t.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),t.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),t.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),t.jsx("span",{className:"text-sm text-gray-500",children:"GÃ¢ndesc..."})]}):t.jsx("div",{className:"prose prose-sm max-w-none "+(i?"prose-invert":""),children:t.jsx(a,{components:{p:({children:e})=>t.jsx("p",{className:"mb-2 last:mb-0",children:e}),ul:({children:e})=>t.jsx("ul",{className:"list-disc pl-4 mb-2",children:e}),ol:({children:e})=>t.jsx("ol",{className:"list-decimal pl-4 mb-2",children:e}),li:({children:e})=>t.jsx("li",{className:"mb-1",children:e}),strong:({children:e})=>t.jsx("strong",{className:"font-semibold",children:e}),code:({children:e})=>t.jsx("code",{className:"px-1 py-0.5 rounded text-xs "+(i?"bg-blue-700":"bg-gray-200"),children:e})},children:s})})}),n&&!r&&t.jsx("span",{className:"text-xs text-gray-500 mt-1 px-2",children:new Date(n).toLocaleTimeString("ro-RO",{hour:"2-digit",minute:"2-digit"})})]})]})})},ce=({tool:e,success:s,message:a,data:n})=>t.jsx("div",{className:"flex justify-center mb-4",children:t.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg px-4 py-2 max-w-[80%]",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:s?"text-green-600":"text-red-600",children:s?"âœ…":"âŒ"}),t.jsx("span",{className:"font-medium text-gray-700",children:e.replace(/_/g," ")}),a&&t.jsxs("span",{className:"text-gray-600",children:["- ",a]})]}),n&&t.jsx("div",{className:"mt-2 text-xs text-gray-500",children:t.jsx("pre",{className:"bg-white p-2 rounded border border-gray-200 overflow-x-auto",children:JSON.stringify(n,null,2)})})]})}),de=()=>{const[a,n]=s.useState(!1),[r,i]=s.useState([]),[o,l]=s.useState(""),[c,d]=s.useState(!1),[m]=s.useState(()=>B()),u=s.useRef(null),h=s.useRef(null);s.useEffect(()=>{u.current?.scrollIntoView({behavior:"smooth"})},[r]),s.useEffect(()=>{a&&h.current?.focus()},[a]),s.useEffect(()=>{g()},[]);const p=()=>{const e=localStorage.getItem("constructai_token");return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}},g=async()=>{try{const e=await fetch(`/api/chat/message?sessionId=${m}`,{headers:p()});if(e.ok){const s=await e.json();s.success&&s.data.length>0&&i(s.data.map(e=>({id:e.id,role:e.role,content:e.content,timestamp:new Date(e.created_at),toolResults:e.metadata?.toolResults})))}}catch(e){}},x=async()=>{if(!o.trim()||c)return;const e={id:B(),role:"user",content:o,timestamp:new Date};i(s=>[...s,e]),l(""),d(!0);try{const e=await fetch("/api/chat/message",{method:"POST",headers:p(),body:JSON.stringify({message:o,sessionId:m,currentPage:window.location.pathname})});if(!e.ok)throw new Error("Failed to send message");const s=await e.json();if(!s.success)throw new Error(s.error||"Unknown error");{const e={id:B(),role:"assistant",content:s.data.message,timestamp:new Date,toolResults:s.data.toolResults};i(s=>[...s,e])}}catch(s){const e={id:B(),role:"assistant",content:`âŒ Ne pare rÄƒu, a apÄƒrut o eroare: ${s.message}. Te rog Ã®ncearcÄƒ din nou.`,timestamp:new Date};i(s=>[...s,e])}finally{d(!1)}};return t.jsxs(t.Fragment,{children:[!a&&t.jsxs("button",{type:"button",onClick:()=>n(!0),className:"fixed bottom-6 right-6 w-16 h-16 bg-gradient-to-br from-purple-600 to-blue-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center z-50 group","aria-label":"Open AI Assistant",children:[t.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:"ðŸ¤–"}),t.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-green-500 rounded-full border-2 border-white animate-pulse"})]}),a&&t.jsxs("div",{className:"fixed bottom-6 right-6 w-96 h-[600px] bg-white rounded-2xl shadow-2xl flex flex-col z-50 border border-gray-200",children:[t.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white p-4 rounded-t-2xl flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-xl",children:"ðŸ¤–"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"ConstructAI Assistant"}),t.jsx("p",{className:"text-xs text-white/80",children:"Asistentul tÄƒu AI personal"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{type:"button",onClick:async()=>{if(confirm("EÈ™ti sigur cÄƒ vrei sÄƒ È™tergi conversaÈ›ia?"))try{await fetch(`/api/chat/message?sessionId=${m}`,{method:"DELETE"}),i([])}catch(e){}},className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"È˜terge conversaÈ›ia",children:"ðŸ—‘ï¸"}),t.jsx("button",{type:"button",onClick:()=>n(!1),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"ÃŽnchide",children:"âœ•"})]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-gray-50",children:0===r.length?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-500",children:[t.jsx("div",{className:"text-6xl mb-4",children:"ðŸ‘‹"}),t.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Bine ai venit!"}),t.jsxs("p",{className:"text-sm",children:["Sunt asistentul tÄƒu AI personal.",t.jsx("br",{}),"Cum te pot ajuta astÄƒzi?"]}),t.jsxs("div",{className:"mt-4 text-xs text-gray-400",children:[t.jsx("p",{children:"ÃŽncearcÄƒ sÄƒ Ã®ntrebi:"}),t.jsxs("ul",{className:"mt-2 space-y-1",children:[t.jsx("li",{children:'â€¢ "CÃ¢te proiecte active am?"'}),t.jsx("li",{children:'â€¢ "Care e statusul financiar?"'}),t.jsx("li",{children:'â€¢ "CreeazÄƒ un proiect nou"'})]})]})]}):t.jsxs(t.Fragment,{children:[r.map(s=>t.jsxs(e.Fragment,{children:[t.jsx(le,{role:s.role,content:s.content,timestamp:s.timestamp}),s.toolResults?.map((e,a)=>t.jsx(ce,{...e},`${s.id}-tool-${a}`))]},s.id)),c&&t.jsx(le,{role:"assistant",content:"",isLoading:!0}),t.jsx("div",{ref:u})]})}),t.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white rounded-b-2xl",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{ref:h,type:"text",value:o,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),x())},placeholder:"Scrie un mesaj...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",disabled:c}),t.jsx("button",{type:"button",onClick:x,disabled:!o.trim()||c,className:"px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c?"â³":"ðŸ“¤"})]}),t.jsx("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"Powered by Google Gemini AI"})]})]})]})};function me(){try{return"true"===localStorage.getItem("autonomy_enabled")}catch{return!1}}const ue=s.lazy(()=>i(()=>import("./UnifiedDashboardScreen-lzc6eomP.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),he=s.lazy(()=>i(()=>import("./ProjectsListScreen-B9nmTZ3x.js"),__vite__mapDeps([14,1,2,4,5,6,7,8,9,10]))),pe=s.lazy(()=>i(()=>import("./ProjectHomeScreen-Q_8G9_7U.js"),__vite__mapDeps([15,1,2,4,5,6,7,8,9,10,12]))),ge=s.lazy(()=>i(()=>import("./MyDayScreen-5LFILwm1.js"),__vite__mapDeps([16,1,2,4,5,6,7,8,9,10,17]))),xe=s.lazy(()=>i(()=>import("./TasksScreen-BYzL3o8n.js"),__vite__mapDeps([18,1,2,4,5,6,7,8,9,10]))),be=s.lazy(()=>i(()=>import("./TaskDetailScreen-HRpYK5Pn.js"),__vite__mapDeps([19,1,2,4,5,6,7,8,9,10,20]))),fe=s.lazy(()=>i(()=>import("./NewTaskScreen-nnWgn9Wb.js"),__vite__mapDeps([21,1,2,4,5,6,7,8,9,10]))),je=s.lazy(()=>i(()=>import("./DailyLogScreen-DvO3U8ow.js"),__vite__mapDeps([22,1,2,4,5,6,7,8,9,10]))),ye=s.lazy(()=>i(()=>import("./PhotoGalleryScreen-DQriBX3E.js"),__vite__mapDeps([23,1,2,4,5,6,7,8,9,10,20]))),_e=s.lazy(()=>i(()=>import("./RFIsScreen-GlqkADCR.js"),__vite__mapDeps([24,1,2,4,5,6,7,8,9,10]))),we=s.lazy(()=>i(()=>import("./RFIDetailScreen-C9e7eIVt.js"),__vite__mapDeps([25,1,2,4,5,6,7,8,9,10]))),ve=s.lazy(()=>i(()=>import("./NewRFIScreen-B2hgCS4L.js"),__vite__mapDeps([26,1,2,4,5,6,7,8,9,10]))),Ne=s.lazy(()=>i(()=>import("./developer-tools-B-VjJpHg.js").then(e=>e.P),__vite__mapDeps([6,1,2,7,8,9,10])).then(e=>({default:e.ProductionSDKDeveloperView}))),ke=s.lazy(()=>i(()=>import("./developer-tools-B-VjJpHg.js").then(e=>e.i),__vite__mapDeps([6,1,2,7,8,9,10]))),Ee=s.lazy(()=>i(()=>import("./developer-tools-B-VjJpHg.js").then(e=>e.j),__vite__mapDeps([6,1,2,7,8,9,10]))),Se=s.lazy(()=>i(()=>import("./developer-tools-B-VjJpHg.js").then(e=>e.k),__vite__mapDeps([6,1,2,7,8,9,10]))),Ae=s.lazy(()=>i(()=>import("./developer-tools-B-VjJpHg.js").then(e=>e.m),__vite__mapDeps([6,1,2,7,8,9,10]))),De=s.lazy(()=>i(()=>import("./developer-tools-B-VjJpHg.js").then(e=>e.n),__vite__mapDeps([6,1,2,7,8,9,10])));s.lazy(()=>i(()=>import("./CompanyAdminDashboardScreen-D4R3urUu.js").then(e=>e.b),__vite__mapDeps([13,1,2,6,7,8,9,10,4,5,12])));const Le=s.lazy(()=>i(()=>import("./CompanyAdminDashboard-5A7kbLDN.js"),__vite__mapDeps([27,1,2,9]))),Ie=s.lazy(()=>i(()=>import("./CompanyAdminDashboardV2-CipYQH_v.js"),__vite__mapDeps([28,1,2,9]))),Te=s.lazy(()=>i(()=>import("./PunchListScreen-Dj-flUPd.js"),__vite__mapDeps([29,1,2,4,5,6,7,8,9,10]))),Pe=s.lazy(()=>i(()=>import("./PunchListItemDetailScreen-BJw_jiOC.js"),__vite__mapDeps([30,1,2,4,5,6,7,8,9,10,20]))),Ce=s.lazy(()=>i(()=>import("./NewPunchListItemScreen-mYfeZXAB.js"),__vite__mapDeps([31,1,2,4,5,6,7,8,9,10]))),Re=s.lazy(()=>i(()=>import("./DrawingsScreen-DliKzJUc.js"),__vite__mapDeps([32,1,2,4,5,6,7,8,9,10]))),ze=s.lazy(()=>i(()=>import("./PlansViewerScreen-KS0Rdc7V.js"),__vite__mapDeps([33,1,2,4,5,6,7,8,9,10]))),Oe=s.lazy(()=>i(()=>import("./DayworkSheetsListScreen-BcA_QnGR.js"),__vite__mapDeps([34,1,2,4,5,6,7,8,9,10]))),Me=s.lazy(()=>i(()=>import("./DayworkSheetDetailScreen-Cm5MbGYj.js"),__vite__mapDeps([35,1,2,4,5,6,7,8,9,10]))),Ve=s.lazy(()=>i(()=>import("./NewDayworkSheetScreen-f21VCGlE.js"),__vite__mapDeps([36,1,2,4,5,6,7,8,9,10]))),$e=s.lazy(()=>i(()=>import("./DocumentsScreen-dFp37QZN.js"),__vite__mapDeps([37,1,2,4,5,6,7,8,9,10]))),Be=s.lazy(()=>i(()=>import("./DeliveryScreen-hVIjAlEb.js"),__vite__mapDeps([38,1,2,4,5,6,7,8,9,10]))),Fe=s.lazy(()=>i(()=>import("./DrawingComparisonScreen-CmpGJV0S.js"),__vite__mapDeps([39,1,2,4,5,6,7,8,9,10]))),qe=s.lazy(()=>i(()=>import("./module-screens-Dy02k3Q1.js").then(e=>e.aR),__vite__mapDeps([4,1,2,5,6,7,8,9,10]))),Ue=s.lazy(()=>i(()=>import("./module-screens-Dy02k3Q1.js").then(e=>e.aS),__vite__mapDeps([4,1,2,5,6,7,8,9,10]))),We=s.lazy(()=>i(()=>import("./module-screens-Dy02k3Q1.js").then(e=>e.aT),__vite__mapDeps([4,1,2,5,6,7,8,9,10]))),He=s.lazy(()=>i(()=>import("./module-screens-Dy02k3Q1.js").then(e=>e.aU),__vite__mapDeps([4,1,2,5,6,7,8,9,10]))),Ke=s.lazy(()=>i(()=>import("./module-screens-Dy02k3Q1.js").then(e=>e.aV),__vite__mapDeps([4,1,2,5,6,7,8,9,10]))),Ge=s.lazy(()=>i(()=>import("./module-screens-Dy02k3Q1.js").then(e=>e.aW),__vite__mapDeps([4,1,2,5,6,7,8,9,10]))),Je=s.lazy(()=>i(()=>import("./module-screens-Dy02k3Q1.js").then(e=>e.aX),__vite__mapDeps([4,1,2,5,6,7,8,9,10]))),Qe=s.lazy(()=>i(()=>import("./module-screens-Dy02k3Q1.js").then(e=>e.aY),__vite__mapDeps([4,1,2,5,6,7,8,9,10]))),Xe=s.lazy(()=>i(()=>import("./MyTasksScreen-DX5yadxE.js"),__vite__mapDeps([40,1,2,4,5,6,7,8,9,10,17]))),Ye=s.lazy(()=>i(()=>import("./PlaceholderToolScreen-BU8eglB7.js"),__vite__mapDeps([41,1,2,4,5,6,7,8,9,10]))),Ze=s.lazy(()=>i(()=>import("./marketplace-9bItVkOZ.js").then(e=>e.G),__vite__mapDeps([42,1,2,9]))),es=s.lazy(()=>i(()=>import("./MyApplicationsDesktop-DE6sxoLa.js"),__vite__mapDeps([43,1,2,9]))),ss=s.lazy(()=>i(()=>import("./marketplace-9bItVkOZ.js").then(e=>e.A),__vite__mapDeps([42,1,2,9]))),ts=s.lazy(()=>i(()=>import("./marketplace-9bItVkOZ.js").then(e=>e.D),__vite__mapDeps([42,1,2,9]))),as=s.lazy(()=>i(()=>import("./Base44Clone-BYK7q9EG.js"),__vite__mapDeps([44,1,2,9,7,4,5,6,8,10,45])).then(e=>({default:e.Base44Clone}))),ns=s.lazy(()=>i(()=>import("./PlatformAdminScreen-BGLYfKt7.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10])));s.lazy(()=>i(()=>import("./SuperAdminDashboardScreen-BQXmOMkk.js"),__vite__mapDeps([11,1,2,8,9])));const rs=s.lazy(()=>i(()=>import("./AdminControlPanel-Bb8eo5nq.js"),__vite__mapDeps([46,1,2,47,9,6,7,8,10]))),is=s.lazy(()=>i(()=>import("./SuperAdminDashboardV2-CLLAhamE.js"),__vite__mapDeps([48,1,2,9])));s.lazy(()=>i(()=>import("./EnhancedSuperAdminDashboard-CYMOePrk.js"),__vite__mapDeps([47,1,2,9])));const os=s.lazy(()=>i(()=>import("./AdvancedMLDashboard-HFVzCm6B.js"),__vite__mapDeps([49,1,2,4,5,6,7,8,9,10]))),ls=s.lazy(()=>i(()=>import("./AnalyticsDashboardScreen-cazcvnzl.js"),__vite__mapDeps([50,1,2,9]))),cs=s.lazy(()=>i(()=>import("./AdvancedSearchScreen-teBg78DZ.js"),__vite__mapDeps([51,1,2,9]))),ds=s.lazy(()=>i(()=>import("./BulkOperationsScreen-BNjg_kTq.js"),__vite__mapDeps([52,1,2,9]))),ms=s.lazy(()=>i(()=>import("./CollaborationHubScreen-B1s5bpo7.js"),__vite__mapDeps([53,1,2,9]))),us=s.lazy(()=>i(()=>import("./AdvancedAnalyticsScreen-BgNWy8iH.js"),__vite__mapDeps([54,1,2,9]))),hs=s.lazy(()=>i(()=>import("./AIRecommendationsScreen-CGbvc5-Q.js"),__vite__mapDeps([55,1,2,9]))),ps=s.lazy(()=>i(()=>import("./AIWorkflowScreen-ByqEVCLh.js"),__vite__mapDeps([56,1,2,9]))),gs=s.lazy(()=>i(()=>import("./SmartTaskAssignmentScreen-CxRYC0tS.js"),__vite__mapDeps([57,1,2,9]))),xs=s.lazy(()=>i(()=>import("./MobileToolsScreen-BbzVaoXk.js"),__vite__mapDeps([58,1,2,9]))),bs=s.lazy(()=>i(()=>import("./IntegrationsScreen-RREOXzQW.js"),__vite__mapDeps([59,1,2,9]))),fs=s.lazy(()=>i(()=>import("./BuildrInspiredDashboard-DDeqLJel.js"),__vite__mapDeps([60,1,2,9]))),js=s.lazy(()=>i(()=>import("./EnhancedProjectManagement-eWwcQS7O.js"),__vite__mapDeps([61,1,2,9]))),ys=s.lazy(()=>i(()=>import("./EnhancedTeamCollaboration-D91-Wumr.js"),__vite__mapDeps([62,1,2,9]))),_s=s.lazy(()=>i(()=>import("./EnhancedFinancialTracking-CTbXviXQ.js"),__vite__mapDeps([63,1,2,9]))),ws=s.lazy(()=>i(()=>import("./EnhancedMobileExperience-BFykZBIp.js"),__vite__mapDeps([64,1,2,9]))),vs=s.lazy(()=>i(()=>import("./CommandCenter-B9ZdKdIo.js"),__vite__mapDeps([65,1,2,6,7,8,9,10]))),Ns=s.lazy(()=>i(()=>import("./EnhancedTeamManagement-HBRD-33R.js"),__vite__mapDeps([66,1,2,6,7,8,9,10]))),ks=s.lazy(()=>i(()=>import("./BudgetForecastingDashboard-DhaThslM.js"),__vite__mapDeps([67,1,2,6,7,8,9,10]))),Es=s.lazy(()=>i(()=>import("./SafetyManagementDashboard-BjxwoHIn.js"),__vite__mapDeps([68,1,2,6,7,8,9,10]))),Ss=s.lazy(()=>i(()=>import("./ResourceOptimizationDashboard-Be2N-i-b.js"),__vite__mapDeps([69,1,2,6,7,8,9,10]))),As=s.lazy(()=>i(()=>import("./WeatherBasedScheduling-BLaBGwwl.js"),__vite__mapDeps([70,1,2,6,7,8,9,10]))),Ds=s.lazy(()=>i(()=>import("./ChangeOrdersManagement-DaNe6nFD.js"),__vite__mapDeps([71,1,2,9]))),Ls=()=>t.jsx("div",{className:"py-16 text-center text-slate-500",children:"Loading experience..."}),Is={"global-dashboard":ue,"company-admin-dashboard":Ie,"company-admin-legacy":Le,projects:he,"project-home":pe,"my-day":ge,tasks:xe,"my-tasks":Xe,"task-detail":be,"new-task":fe,"daily-log":je,photos:ye,rfis:_e,"rfi-detail":we,"new-rfi":ve,"punch-list":Te,"punch-list-item-detail":Pe,"new-punch-list-item":Ce,drawings:Re,plans:ze,"daywork-sheets":Oe,"daywork-sheet-detail":Me,"new-daywork-sheet":Ve,documents:$e,delivery:Be,"drawing-comparison":Fe,accounting:qe,"ai-tools":Ue,"document-management":We,"time-tracking":He,"project-operations":Ke,"financial-management":Ge,"business-development":Je,"ai-agents-marketplace":Qe,"developer-dashboard":Se,"automation-studio":De,"developer-workspace":ke,"developer-console":Ee,"super-admin-dashboard":is,"sdk-developer":Ne,"my-apps-desktop":as,marketplace:Ze,"my-applications":es,"admin-review":ss,"developer-submissions":ts,"platform-admin":ns,"admin-control-panel":rs,"ml-analytics":os,"analytics-dashboard":ls,"advanced-search":cs,"bulk-operations":ds,"collaboration-hub":ms,"advanced-analytics":us,"ai-recommendations":hs,"ai-workflow":ps,"smart-task-assignment":gs,"mobile-tools":xs,integrations:bs,"buildr-dashboard":fs,"enhanced-project-management":js,"enhanced-team-collaboration":ys,"enhanced-financial-tracking":_s,"enhanced-mobile-experience":ws,"command-center":vs,"team-management":Ns,"budget-forecasting":ks,"safety-management":Es,"resource-optimization":Ss,"weather-scheduling":As,"change-orders":Ds,"placeholder-tool":Ye},Ts=()=>{const[e,a]=s.useState(null),[n,r]=s.useState(!1),[i,o]=s.useState([]),{navigationStack:l,currentNavItem:c,navigateTo:d,navigateToModule:m,goBack:u,goHome:h,selectProject:p,handleDeepLink:g,setNavigationStack:x}=(()=>{const[e,t]=s.useState([]),a=s.useCallback((e,s={},a)=>{t(t=>[...t,{screen:e,params:s,project:a}])},[]),n=s.useCallback((e,s={})=>{t([{screen:e,params:s,project:void 0}])},[]),r=s.useCallback(()=>{e.length>1&&t(e=>e.slice(0,-1))},[e]),i=s.useCallback(e=>{e?t(s=>[s[0],{screen:"project-home",project:e}]):n("global-dashboard")},[n]),o=s.useCallback(e=>{t([{screen:"project-home",project:e}])},[]),l=s.useCallback((e,s,n,r)=>{if(e){const a=r.find(s=>s.id===e);a&&t([{screen:"project-home",project:a},{screen:s,params:n,project:a}])}else a(s,n)},[a]),c=e[e.length-1];return{navigationStack:e,currentNavItem:c,navigateTo:a,navigateToModule:n,goBack:r,goHome:i,selectProject:o,handleDeepLink:l,setNavigationStack:t}})(),[b,f]=s.useState(!1),[j,y]=s.useState(!1),[_,w]=s.useState(null),[v,N]=s.useState(!1),[k,E]=s.useState(()=>()=>{}),[S,A]=s.useState(""),{can:D}=H(e),{toasts:L,removeToast:T,showSuccess:C}=(()=>{const[e,t]=s.useState([]),a=s.useCallback(e=>{const s=`toast-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,a={...e,id:s};t(e=>[...e,a]),setTimeout(()=>{n(s)},e.duration||5e3)},[]),n=s.useCallback(e=>{t(s=>s.filter(s=>s.id!==e))},[]),r=s.useCallback((e,s)=>{a({type:"success",title:e,message:s})},[a]),i=s.useCallback((e,s)=>{a({type:"error",title:e,message:s})},[a]),o=s.useCallback((e,s)=>{a({type:"warning",title:e,message:s})},[a]),l=s.useCallback((e,s)=>{a({type:"info",title:e,message:s})},[a]);return{toasts:e,addToast:a,removeToast:n,showSuccess:r,showError:i,showWarning:o,showInfo:l}})();s.useEffect(()=>{(async()=>{try{const e=await O();if(e){if(a(e),0===l.length){const s="developer"===e.role?"developer-console":"super_admin"===e.role?"super-admin-dashboard":"company-admin-dashboard";m(s,{})}window.dispatchEvent(new CustomEvent("userLoggedIn"))}}catch(e){}finally{r(!0)}})()},[]),s.useEffect(()=>{const s=()=>{if("#dashboard"===window.location.hash&&e){const s="developer"===e.role?"developer-console":"super_admin"===e.role?"super-admin-dashboard":"company-admin-dashboard";m(s,{}),window.history.replaceState(null,"",window.location.pathname)}};return s(),window.addEventListener("hashchange",s),()=>{window.removeEventListener("hashchange",s)}},[e]),s.useEffect(()=>{if(e){if((async()=>{const s=await I(e);o(s)})(),0===l.length){const s="developer"===e.role?"developer-console":"super_admin"===e.role?"super-admin-dashboard":"company-admin-dashboard";m(s,{})}}else l.length>0&&x([]),o([])},[e]),s.useEffect(()=>{let s=null;return e&&me()&&(s=function(e){if(!e||!me())return()=>{};const s=[],t=[],a=window.setInterval(async()=>{try{if(!R)return;if((await R.from("tasks").select("id").limit(1)).error)return;await R.from("tasks").update({schedule_status:"review_pending"}).eq("weather_sensitive",!0)}catch{}},9e5);s.push(a);try{if(R){const s=R.channel(`autonomy:notifications:${e.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${e.id}`},async e=>{try{const s=e.new;"ai_suggestion"!==s?.type||s?.applied||await R.from("notifications").update({applied:!0}).eq("id",s.id)}catch{}}).subscribe();t.push(()=>{s.unsubscribe()})}}catch{}return()=>{s.forEach(e=>window.clearInterval(e)),t.forEach(e=>e())}}(e)),()=>{s&&s()}},[e]),s.useEffect(()=>{const e=()=>{V()};return window.addEventListener("userLoggedOutTrigger",e),()=>window.removeEventListener("userLoggedOutTrigger",e)},[]);const z=e=>{a(e),window.dispatchEvent(new CustomEvent("userLoggedIn")),C("Welcome back!",`Hello ${e.name}`)},V=async()=>{oe.logUserAction("logout_initiated",{userId:e?.id},e?.id),await M(),a(null),x([]),window.dispatchEvent(new CustomEvent("userLoggedOut")),C("Logged out","You have been successfully logged out"),oe.logUserAction("logout_successful",{userId:e?.id},e?.id)},$=s.useCallback((e,s)=>{A(e),E(()=>e=>{s(e),N(!1)}),N(!0)},[]),B=s.useCallback((e,s,t)=>{g(e,s,t,i)},[g,i]),F=e=>{$(`Select a project for the new ${e.split("-")[1]}`,s=>{g(s,e,{},i)})},q=async()=>{if(!e)return;f(!0),y(!0),w(null);const s=await P(e);w(s),y(!1)};if(!n)return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:t.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-2xl text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-700 font-medium",children:"Loading session..."}),t.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"This should only take a moment"})]})});if(!e)return t.jsx("div",{className:"bg-slate-100 min-h-screen flex items-center justify-center",children:t.jsx(U,{onLoginSuccess:z})});if(!c||0===l.length){const a={currentUser:e,navigateTo:d,onDeepLink:B,onQuickAction:F,onSuggestAction:q,selectProject:e=>{const s=i.find(s=>s.id===e);s&&p(s)},can:()=>!0,goBack:u};return"developer"===e.role?t.jsx(s.Suspense,{fallback:t.jsx(Ls,{}),children:t.jsx(Ae,{currentUser:e,navigateTo:m,isDarkMode:!0})}):"super_admin"===e.role?t.jsx(s.Suspense,{fallback:t.jsx(Ls,{}),children:t.jsx(is,{isDarkMode:!0,onNavigate:e=>{toast.success(`Opening ${e}...`)}})}):"company_admin"===e.role?t.jsx(s.Suspense,{fallback:t.jsx(Ls,{}),children:t.jsx(Ie,{currentUser:e,navigateTo:m,isDarkMode:!0})}):t.jsx("div",{className:"min-h-screen bg-gray-50",children:t.jsx(s.Suspense,{fallback:t.jsx(Ls,{}),children:t.jsx(ue,{...a})})})}const{screen:K,params:G,project:Z}=c;if("super-admin-dashboard"===K)return t.jsx(s.Suspense,{fallback:t.jsx(Ls,{}),children:t.jsx(is,{isDarkMode:!0,onNavigate:e=>{toast.success(`Opening ${e}...`)}})});const ee=Is[K]||Ye;if(!ee)return t.jsxs("div",{className:"p-8 text-red-700",children:["Screen not available: ",K]});if("my-apps-desktop"===K)return t.jsx(s.Suspense,{fallback:t.jsx(Ls,{}),children:t.jsx(as,{user:e,onLogout:V})});const se=s.useMemo(()=>Z||{...Q,id:"",name:"Global View",location:`Welcome, ${e?.name||"User"}`},[Z,e?.name]),te=s.useCallback(()=>{"developer"!==e.role?"super_admin"!==e.role?"company_admin"!==e.role?h():m("company-admin-dashboard"):m("super-admin-dashboard"):m("developer-console")},[e.role,m,h]);return t.jsxs("div",{className:"bg-slate-50",children:[t.jsx(W,{sidebar:t.jsx(J,{project:se,navigateTo:d,navigateToModule:m,goHome:te,currentUser:e,onLogout:V}),floatingMenu:t.jsx(ne,{currentUser:e,navigateToModule:m,openProjectSelector:$,onDeepLink:B}),children:t.jsx("div",{className:"p-8",children:t.jsx(s.Suspense,{fallback:t.jsx(Ls,{}),children:t.jsx(ee,{currentUser:e,selectProject:p,navigateTo:d,onDeepLink:g,onQuickAction:F,onSuggestAction:q,openProjectSelector:$,project:Z,goBack:u,can:D,...G})})})}),t.jsx(X,{isOpen:b,isLoading:j,suggestion:_,onClose:()=>f(!1),onAction:e=>{e.projectId&&g(e.projectId,e.screen,e.params,i),f(!1)},currentUser:e}),v&&t.jsx(Y,{title:S,onClose:()=>N(!1),onSelectProject:k,currentUser:e}),t.jsx(ie,{toasts:L,onRemoveToast:T}),e&&t.jsx(de,{})]})};class Ps extends s.Component{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){}render(){return this.state.hasError?this.props.fallback?this.props.fallback:t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:t.jsx("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("svg",{className:"h-8 w-8 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),t.jsxs("div",{className:"ml-3",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-800",children:"Something went wrong"}),t.jsxs("div",{className:"mt-2 text-sm text-gray-700",children:[t.jsx("p",{children:"An unexpected error occurred. Please try refreshing the page."}),!1]}),t.jsx("div",{className:"mt-4",children:t.jsx("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Refresh Page"})})]})]})})}):this.props.children}}const Cs=document.getElementById("root");if(!Cs)throw new Error("Could not find root element to mount to");n.createRoot(Cs).render(t.jsx(e.StrictMode,{children:t.jsx(Ps,{children:t.jsx(Ts,{})})}));export{de as C,ae as N,te as a,H as u};
