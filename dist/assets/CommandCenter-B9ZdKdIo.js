import{r as e,j as t}from"./react-core-FGHlRSau.js";import{s}from"./developer-tools-B-VjJpHg.js";import{a$ as a,ap as r,ba as o,Z as l,a as i,s as n,aw as c,ac as d,aQ as m,D as x,S as h,p,ad as u,b as g}from"./icon-pack-tZfEXMDa.js";import"./vendor-BX0gT1qP.js";import"./supabase-DKHGIEFa.js";import"./axios-ei4kQ0Q2.js";import"./monaco-Bh77eHRb.js";const b=({currentUser:b,navigateTo:j})=>{const[f,v]=e.useState([]),[N,w]=e.useState([]),[y,k]=e.useState(!0);e.useEffect(()=>{C()},[]);const C=async()=>{try{if(!s)return void k(!1);const{count:e}=await s.from("projects").select("id",{count:"exact",head:!0}),{count:t}=await s.from("users").select("id",{count:"exact",head:!0}),[{count:l},{count:i}]=await Promise.all([s.from("tasks").select("id",{count:"exact",head:!0}),s.from("tasks").select("id",{count:"exact",head:!0}).eq("status","completed")]),n=l&&i?Math.round(i/Math.max(l,1)*100):0,{data:c}=await s.from("notifications").select("id, type, message, created_at").eq("user_id",b.id).order("created_at",{ascending:!1}).limit(10),d=(c||[]).map(e=>({id:e.id,type:e.type||"info",title:e.type?e.type.charAt(0).toUpperCase()+e.type.slice(1):"Info",message:e.message||"",timestamp:new Date(e.created_at),action:void 0}));v([{title:"Active Projects",value:e??0,change:0,trend:"stable",icon:a,color:"blue",onClick:()=>j("projects")},{title:"Team Members",value:t??0,change:0,trend:"stable",icon:r,color:"purple",onClick:()=>j("enhanced-team-collaboration")},{title:"Tasks Completion",value:`${n}%`,change:0,trend:"stable",icon:o,color:"orange",onClick:()=>j("tasks")}]),w(d)}finally{k(!1)}},$=e=>{const t={blue:"from-blue-500 to-blue-600",green:"from-green-500 to-green-600",purple:"from-purple-500 to-purple-600",orange:"from-orange-500 to-orange-600",red:"from-red-500 to-red-600",cyan:"from-cyan-500 to-cyan-600"};return t[e]||t.blue},M=e=>{const t=new Date,s=Math.floor((t.getTime()-e.getTime())/1e3);return s<60?"Just now":s<3600?`${Math.floor(s/60)}m ago`:s<86400?`${Math.floor(s/3600)}h ago`:`${Math.floor(s/86400)}d ago`};return y?t.jsx("div",{className:"flex h-full items-center justify-center",children:t.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-blue-600 border-t-transparent"})}):t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx(l,{className:"h-8 w-8 text-blue-600"}),t.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Command Center"})]}),t.jsx("p",{className:"text-gray-600 text-lg",children:"Real-time oversight of all construction operations"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:f.map((e,s)=>{const a=e.icon;return t.jsxs("div",{onClick:e.onClick,className:`relative overflow-hidden rounded-xl bg-gradient-to-br ${$(e.color)} p-6 text-white shadow-lg hover:shadow-xl transition-all cursor-pointer transform hover:scale-105`,children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-white/80 mb-1",children:e.title}),t.jsx("p",{className:"text-3xl font-bold mb-2",children:e.value}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(i,{className:"h-4 w-4 "+("down"===e.trend?"rotate-180":"")}),t.jsxs("span",{className:"text-sm font-medium",children:["up"===e.trend?"+":"down"===e.trend?"-":"",e.change,"%"]}),t.jsx("span",{className:"text-xs text-white/70",children:"vs last month"})]})]}),t.jsx("div",{className:"ml-4 p-3 bg-white/20 rounded-lg backdrop-blur-sm",children:t.jsx(a,{className:"h-8 w-8"})})]}),t.jsx("div",{className:"absolute bottom-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mb-16"})]},s)})}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 mb-8",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(n,{className:"h-6 w-6 text-orange-600"}),t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Critical Alerts"})]}),t.jsxs("span",{className:"px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm font-medium",children:[N.length," Active"]})]})}),t.jsx("div",{className:"divide-y divide-gray-200",children:N.map(e=>{return t.jsx("div",{className:`p-6 border-l-4 ${"critical"===e.type?"border-red-500":"warning"===e.type?"border-yellow-500":"border-blue-500"} hover:bg-gray-50 transition-colors`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[(s=e.type,{critical:t.jsx(n,{className:"h-5 w-5 text-red-600"}),warning:t.jsx(n,{className:"h-5 w-5 text-yellow-600"}),info:t.jsx(g,{className:"h-5 w-5 text-blue-600"})}[s]),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:e.title}),t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.message}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs text-gray-500",children:M(e.timestamp)}),e.action&&t.jsxs("button",{className:"text-sm font-medium text-blue-600 hover:text-blue-800",children:[e.action," â†’"]})]})]})]})},e.id);var s})})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{title:"Reports",icon:c,screen:"analytics-dashboard",color:"blue"},{title:"Team",icon:r,screen:"enhanced-team-collaboration",color:"purple"},{title:"Calendar",icon:d,screen:"time-tracking",color:"green"},{title:"Equipment",icon:m,screen:"project-operations",color:"orange"},{title:"Budget",icon:x,screen:"financial-management",color:"emerald"},{title:"Quality",icon:h,screen:"quality-control-vision",color:"red"},{title:"Resources",icon:p,screen:"project-operations",color:"indigo"},{title:"Sites",icon:u,screen:"mobile-tools",color:"cyan"}].map((e,s)=>{const a=e.icon;return t.jsxs("button",{onClick:()=>j(e.screen),className:"group relative overflow-hidden bg-white rounded-xl p-6 shadow-md hover:shadow-xl transition-all border border-gray-200 hover:border-blue-300",children:[t.jsxs("div",{className:"flex flex-col items-center text-center gap-3",children:[t.jsx("div",{className:`p-4 bg-${e.color}-50 rounded-xl group-hover:scale-110 transition-transform`,children:t.jsx(a,{className:`h-8 w-8 text-${e.color}-600`})}),t.jsx("span",{className:"font-semibold text-gray-900",children:e.title})]}),t.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-blue-50 to-transparent rounded-bl-full opacity-0 group-hover:opacity-100 transition-opacity"})]},s)})})]})})};export{b as CommandCenter};
