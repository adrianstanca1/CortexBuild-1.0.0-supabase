import{r as e,j as s}from"./react-core-FGHlRSau.js";import{be as t,bf as a,b1 as r,bg as n,bh as l,bi as i,bj as o,Q as d}from"./icon-pack-tZfEXMDa.js";import"./vendor-BX0gT1qP.js";const c=({projectId:c,currentUser:m,className:x=""})=>{const[u,h]=e.useState("chat"),[p,g]=e.useState("general"),[j,y]=e.useState([]),[b,f]=e.useState([]),[v,N]=e.useState(""),[w,k]=e.useState(""),[C,S]=e.useState(!1),[T,D]=e.useState(null),[M,R]=e.useState(null),[E,Z]=e.useState(null),I=e.useRef(null),J=e.useRef(null),F=[{id:"1",content:"Good morning team! Ready for the foundation inspection today?",sender:{id:"user1",name:"John Smith",avatar:"/avatars/john.jpg",role:"Project Manager"},timestamp:"2024-01-20T09:00:00Z",type:"text",reactions:[{emoji:"ðŸ‘",users:["user2","user3"]},{emoji:"ðŸš€",users:["user1"]}]},{id:"2",content:"Yes, all equipment is ready. Weather looks good too!",sender:{id:"user2",name:"Sarah Johnson",avatar:"/avatars/sarah.jpg",role:"Site Supervisor"},timestamp:"2024-01-20T09:05:00Z",type:"text",replyTo:{id:"1",content:"Good morning team! Ready for the foundation inspection today?",sender:"John Smith"}},{id:"3",content:"I've uploaded the inspection checklist. Please review before we start.",sender:{id:"user3",name:"Mike Wilson",avatar:"/avatars/mike.jpg",role:"Safety Officer"},timestamp:"2024-01-20T09:10:00Z",type:"file",attachments:[{name:"inspection_checklist.pdf",url:"/files/inspection_checklist.pdf",type:"application/pdf",size:245760}]}],K=[{id:"1",content:"The foundation looks solid. No cracks or settling issues detected.",author:{id:"user1",name:"John Smith",avatar:"/avatars/john.jpg"},timestamp:"2024-01-20T10:30:00Z",replies:[{id:"2",content:"Agreed. The concrete quality is excellent.",author:{id:"user2",name:"Sarah Johnson",avatar:"/avatars/sarah.jpg"},timestamp:"2024-01-20T10:35:00Z",replies:[]}],reactions:[{emoji:"âœ…",users:["user2","user3"]}]},{id:"3",content:"We should schedule the next inspection for next week.",author:{id:"user3",name:"Mike Wilson",avatar:"/avatars/mike.jpg"},timestamp:"2024-01-20T11:00:00Z",replies:[],reactions:[{emoji:"ðŸ“…",users:["user1"]}]}];e.useEffect(()=>{y(F),f(K)},[]),e.useEffect(()=>{W()},[j]);const W=()=>{I.current?.scrollIntoView({behavior:"smooth"})},z=()=>{if(!v.trim())return;const e={id:Date.now().toString(),content:v,sender:m,timestamp:(new Date).toISOString(),type:"text",replyTo:T?{id:T.id,content:T.content,sender:T.sender.name}:void 0};y(s=>[...s,e]),N(""),D(null)},U=(e,s)=>{y(t=>t.map(t=>{if(t.id===e){const e=t.reactions?.find(e=>e.emoji===s);return e?e.users.includes(m.id)?{...t,reactions:t.reactions?.map(e=>e.emoji===s?{...e,users:e.users.filter(e=>e!==m.id)}:e).filter(e=>e.users.length>0)}:{...t,reactions:t.reactions?.map(e=>e.emoji===s?{...e,users:[...e.users,m.id]}:e)}:{...t,reactions:[...t.reactions||[],{emoji:s,users:[m.id]}]}}return t}))},A=e=>{const s=new Date(e),t=(new Date).getTime()-s.getTime();return t<6e4?"Just now":t<36e5?`${Math.floor(t/6e4)}m ago`:t<864e5?`${Math.floor(t/36e5)}h ago`:s.toLocaleDateString()},G=e=>e.split(" ").map(e=>e[0]).join("").toUpperCase();return s.jsxs("div",{className:`collaboration-hub bg-white rounded-lg shadow-sm border border-gray-200 ${x}`,children:[s.jsxs("div",{className:"border-b border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(t,{className:"w-6 h-6 text-blue-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Collaboration Hub"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100",children:s.jsx(a,{className:"w-5 h-5"})}),s.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100",children:s.jsx(r,{className:"w-5 h-5"})}),s.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100",children:s.jsx(n,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"flex gap-1 mt-4",children:[s.jsx("button",{onClick:()=>h("chat"),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors "+("chat"===u?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:"Chat"}),s.jsx("button",{onClick:()=>h("comments"),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors "+("comments"===u?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:"Comments"})]})]}),s.jsxs("div",{className:"flex h-96",children:["chat"===u&&s.jsx("div",{className:"w-64 border-r border-gray-200 bg-gray-50",children:s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Channels"}),s.jsx("div",{className:"space-y-1",children:[{id:"general",name:"General",type:"public",description:"General project discussion",members:["user1","user2","user3"],unreadCount:2,lastMessage:{content:"The foundation inspection is scheduled for tomorrow",timestamp:"2024-01-20T10:30:00Z",sender:"John Smith"}},{id:"updates",name:"Updates",type:"public",description:"Project updates and announcements",members:["user1","user2","user3"],unreadCount:0,lastMessage:{content:"Weekly progress report is ready",timestamp:"2024-01-19T15:45:00Z",sender:"Sarah Johnson"}},{id:"safety",name:"Safety",type:"public",description:"Safety protocols and incidents",members:["user1","user2","user3"],unreadCount:1,lastMessage:{content:"Remember to wear hard hats in zone A",timestamp:"2024-01-20T08:15:00Z",sender:"Mike Wilson"}}].map(e=>s.jsxs("button",{onClick:()=>g(e.id),className:"w-full text-left p-2 rounded-md transition-colors "+(p===e.id?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"),children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(l,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:e.name})]}),e.unreadCount>0&&s.jsx("span",{className:"bg-blue-600 text-white text-xs rounded-full px-2 py-1 min-w-[20px] text-center",children:e.unreadCount})]}),e.lastMessage&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1 truncate",children:[e.lastMessage.sender,": ",e.lastMessage.content]})]},e.id))})]})}),s.jsx("div",{className:"flex-1 flex flex-col",children:"chat"===u?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[j.map(e=>s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:e.sender.avatar?s.jsx("img",{src:e.sender.avatar,alt:e.sender.name,className:"w-8 h-8 rounded-full"}):s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:G(e.sender.name)})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.sender.name}),s.jsx("span",{className:"text-xs text-gray-500",children:e.sender.role}),s.jsx("span",{className:"text-xs text-gray-400",children:A(e.timestamp)}),e.edited&&s.jsx("span",{className:"text-xs text-gray-400",children:"(edited)"})]}),e.replyTo&&s.jsxs("div",{className:"bg-gray-50 border-l-2 border-blue-200 pl-3 py-2 mb-2 rounded-r-md",children:[s.jsxs("p",{className:"text-xs text-gray-600",children:["Replying to ",e.replyTo.sender]}),s.jsx("p",{className:"text-sm text-gray-700 truncate",children:e.replyTo.content})]}),M===e.id?s.jsxs("div",{className:"flex gap-2",children:[s.jsx("textarea",{defaultValue:e.content,className:"flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm",onKeyDown:s=>{var t,a;"Enter"!==s.key||s.shiftKey||(s.preventDefault(),t=e.id,a=s.currentTarget.value,y(e=>e.map(e=>e.id===t?{...e,content:a,edited:!0,editedAt:(new Date).toISOString()}:e)),R(null)),"Escape"===s.key&&R(null)},autoFocus:!0}),s.jsx("button",{onClick:()=>R(null),className:"px-3 py-2 text-sm text-gray-500 hover:text-gray-700",children:"Cancel"})]}):s.jsxs("div",{className:"group",children:[s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:e.content}),e.attachments&&s.jsx("div",{className:"space-y-2 mb-2",children:e.attachments.map((e,t)=>s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md",children:[s.jsx(i,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-700",children:e.name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(e.size/1024).toFixed(1)," KB)"]})]},t))}),e.reactions&&e.reactions.length>0&&s.jsx("div",{className:"flex gap-1 mb-2",children:e.reactions.map((t,a)=>s.jsxs("button",{onClick:()=>U(e.id,t.emoji),className:"flex items-center gap-1 px-2 py-1 rounded-full text-xs transition-colors "+(t.users.includes(m.id)?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[s.jsx("span",{children:t.emoji}),s.jsx("span",{children:t.users.length})]},a))}),s.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx("button",{onClick:()=>D(e),className:"text-xs text-gray-500 hover:text-gray-700",children:"Reply"}),e.sender.id===m.id&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>R(e.id),className:"text-xs text-gray-500 hover:text-gray-700",children:"Edit"}),s.jsx("button",{onClick:()=>{return s=e.id,void y(e=>e.filter(e=>e.id!==s));var s},className:"text-xs text-red-500 hover:text-red-700",children:"Delete"})]}),s.jsx("button",{onClick:()=>U(e.id,"ðŸ‘"),className:"text-xs text-gray-500 hover:text-gray-700",children:"React"})]})]})]})]},e.id)),s.jsx("div",{ref:I})]}),s.jsxs("div",{className:"border-t border-gray-200 p-4",children:[T&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-2 mb-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm text-blue-700",children:["Replying to ",T.sender.name]}),s.jsx("button",{onClick:()=>D(null),className:"text-blue-500 hover:text-blue-700",children:s.jsx(X,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-xs text-blue-600 truncate",children:T.content})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("textarea",{ref:J,value:v,onChange:e=>N(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),z())},placeholder:"Type a message...",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm resize-none focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",rows:1}),s.jsxs("div",{className:"absolute right-2 top-2 flex gap-1",children:[s.jsx("button",{className:"p-1 text-gray-400 hover:text-gray-600",children:s.jsx(i,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>S(!C),className:"p-1 text-gray-400 hover:text-gray-600",children:s.jsx(o,{className:"w-4 h-4"})})]})]}),s.jsx("button",{onClick:z,disabled:!v.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:s.jsx(d,{className:"w-4 h-4"})})]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:b.map(e=>s.jsx("div",{className:"border-b border-gray-100 pb-4 last:border-b-0",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:e.author.avatar?s.jsx("img",{src:e.author.avatar,alt:e.author.name,className:"w-8 h-8 rounded-full"}):s.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:G(e.author.name)})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.author.name}),s.jsx("span",{className:"text-xs text-gray-400",children:A(e.timestamp)})]}),E===e.id?s.jsxs("div",{className:"flex gap-2",children:[s.jsx("textarea",{defaultValue:e.content,className:"flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm",onKeyDown:s=>{var t,a;"Enter"!==s.key||s.shiftKey||(s.preventDefault(),t=e.id,a=s.currentTarget.value,f(e=>e.map(e=>e.id===t?{...e,content:a}:e)),Z(null)),"Escape"===s.key&&Z(null)},autoFocus:!0}),s.jsx("button",{onClick:()=>Z(null),className:"px-3 py-2 text-sm text-gray-500 hover:text-gray-700",children:"Cancel"})]}):s.jsxs("div",{className:"group",children:[s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:e.content}),e.reactions&&e.reactions.length>0&&s.jsx("div",{className:"flex gap-1 mb-2",children:e.reactions.map((e,t)=>s.jsxs("button",{className:"flex items-center gap-1 px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors",children:[s.jsx("span",{children:e.emoji}),s.jsx("span",{children:e.users.length})]},t))}),s.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx("button",{className:"text-xs text-gray-500 hover:text-gray-700",children:"Reply"}),e.author.id===m.id&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>Z(e.id),className:"text-xs text-gray-500 hover:text-gray-700",children:"Edit"}),s.jsx("button",{onClick:()=>{return s=e.id,void f(e=>e.filter(e=>e.id!==s));var s},className:"text-xs text-red-500 hover:text-red-700",children:"Delete"})]}),s.jsx("button",{className:"text-xs text-gray-500 hover:text-gray-700",children:"React"})]})]}),e.replies.length>0&&s.jsx("div",{className:"ml-4 mt-3 space-y-3",children:e.replies.map(e=>s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:e.author.avatar?s.jsx("img",{src:e.author.avatar,alt:e.author.name,className:"w-6 h-6 rounded-full"}):s.jsx("div",{className:"w-6 h-6 bg-gray-400 rounded-full flex items-center justify-center text-white text-xs font-medium",children:G(e.author.name)})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-xs font-medium text-gray-900",children:e.author.name}),s.jsx("span",{className:"text-xs text-gray-400",children:A(e.timestamp)})]}),s.jsx("p",{className:"text-xs text-gray-700",children:e.content})]})]},e.id))})]})]})},e.id))}),s.jsx("div",{className:"border-t border-gray-200 p-4",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"flex-1 relative",children:s.jsx("textarea",{value:w,onChange:e=>k(e.target.value),placeholder:"Add a comment...",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm resize-none focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",rows:2})}),s.jsx("button",{onClick:()=>{if(!w.trim())return;const e={id:Date.now().toString(),content:w,author:{id:m.id,name:m.name,avatar:m.avatar},timestamp:(new Date).toISOString(),replies:[]};f(s=>[...s,e]),k("")},disabled:!w.trim(),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:s.jsx(d,{className:"w-4 h-4"})})]})})]})})]})]})},m=({currentUser:e,projectId:t})=>s.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Collaboration Hub"}),s.jsx("p",{className:"text-gray-600",children:"Communicate and collaborate with your team in real-time"})]}),s.jsx(c,{projectId:t,currentUser:{id:e.id,name:e.name,avatar:e.avatar,role:e.role},className:"h-[600px]"})]});export{m as CollaborationHubScreen};
