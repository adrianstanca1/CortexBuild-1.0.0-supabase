import{r as e,j as s}from"./react-core-FGHlRSau.js";import{s as t}from"./developer-tools-B-VjJpHg.js";import{S as a,e as r,a as l,aM as d,A as i}from"./icon-pack-tZfEXMDa.js";import"./vendor-BX0gT1qP.js";import"./supabase-DKHGIEFa.js";import"./axios-ei4kQ0Q2.js";import"./monaco-Bh77eHRb.js";const n=({currentUser:n,goBack:c})=>{const[o,x]=e.useState([]),[m,g]=e.useState(!0);e.useEffect(()=>{(async()=>{try{if(!t)return void x([]);const{data:e}=await t.from("incidents").select("id, severity, description, occurred_at, resolved, project:projects(name)").order("occurred_at",{ascending:!1}).limit(20),s=(e||[]).map(e=>({id:e.id,type:"violation",severity:e.severity,description:e.description||"",project:e.project?.name||"Project",date:new Date(e.occurred_at),status:e.resolved?"resolved":"open",reportedBy:""}));x(s)}finally{g(!1)}})()},[]);const h=e=>{const s={good:"bg-green-100 text-green-800 border-green-200",warning:"bg-yellow-100 text-yellow-800 border-yellow-200",critical:"bg-red-100 text-red-800 border-red-200"};return s[e]||s.good};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(a,{className:"h-8 w-8 text-green-600"}),s.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Safety Management"})]}),s.jsx("p",{className:"text-gray-600 text-lg",children:"Industry-leading safety oversight and compliance tracking"})]}),s.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 shadow-lg font-medium",children:[s.jsx(r,{className:"h-5 w-5"}),"Report Incident"]})]})}),s.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-8 shadow-xl text-white mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Overall Safety Score"}),s.jsx("div",{className:"text-6xl font-bold mb-4",children:"98%"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(l,{className:"h-5 w-5"}),s.jsx("span",{className:"text-lg",children:"+2.5% from last month"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("div",{className:"text-4xl font-bold",children:"127"}),s.jsx("div",{className:"text-sm text-green-100",children:"Days without incident"})]}),s.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[s.jsx(d,{className:"h-6 w-6"}),s.jsx("span",{children:"Industry Leader"})]})]})]})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[{label:"Days Without Incident",value:127,target:365,status:"good",trend:"up"},{label:"Safety Score",value:"98%",target:"95%",status:"good",trend:"up"},{label:"Active Certifications",value:42,target:50,status:"warning",trend:"up"},{label:"Toolbox Talks",value:24,target:52,status:"warning",trend:"stable"},{label:"PPE Compliance",value:"99%",target:"100%",status:"good",trend:"stable"},{label:"Inspections Passed",value:"96%",target:"95%",status:"good",trend:"up"}].map((e,t)=>s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:e.label}),s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${h(e.status)}`,children:e.status})]}),s.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[s.jsx("div",{className:"text-3xl font-bold text-gray-900",children:e.value}),s.jsxs("div",{className:"text-sm text-gray-500",children:["/ ",e.target]})]}),s.jsxs("div",{className:"flex items-center gap-1 text-sm",children:["up"===e.trend?s.jsx(l,{className:"h-4 w-4 text-green-600"}):"down"===e.trend?s.jsx(l,{className:"h-4 w-4 text-red-600 rotate-180"}):s.jsx(i,{className:"h-4 w-4 text-gray-600"}),s.jsx("span",{className:"up"===e.trend?"text-green-600":"down"===e.trend?"text-red-600":"text-gray-600",children:"stable"===e.trend?"Stable":"up"===e.trend?"Improving":"Declining"})]})]},t))}),s.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Recent Incidents"}),s.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"View All â†’"})]})}),s.jsx("div",{className:"divide-y divide-gray-200",children:o.map(e=>{return s.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx(r,{className:"h-5 w-5 flex-shrink-0 "+("critical"===e.severity?"text-red-600":"high"===e.severity?"text-orange-600":"medium"===e.severity?"text-yellow-600":"text-blue-600")}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:e.description}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${t=e.severity,{low:"bg-blue-100 text-blue-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"}[t]}`,children:e.severity})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 mb-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Project:"})," ",e.project]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Type:"})," ",e.type]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Reported:"})," ",e.reportedBy]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Status:"})," ",e.status]})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[e.date.toLocaleDateString()," at ",e.date.toLocaleTimeString()]})]})]})},e.id);var t})})]})]})})};export{n as SafetyManagementDashboard};
