import{r as e,z as s,j as i}from"./react-core-FGHlRSau.js";import{V as a,Y as t,i as l,o as n,p as o,al as r,aY as c,az as d,P as x,M as p,$ as m,a0 as h,X as u}from"./icon-pack-tZfEXMDa.js";import"./vendor-BX0gT1qP.js";const w=({isDarkMode:w=!0,currentUser:j})=>{const[g,N]=e.useState([]),[b,v]=e.useState([]),[f,y]=e.useState("grid"),[$,z]=e.useState(""),[I,M]=e.useState(!0),[C,k]=e.useState(100),[S,L]=e.useState(null),[P,_]=e.useState({x:0,y:0}),D=w?"bg-gray-900":"bg-gray-100",Y=w?"bg-gray-800 border-gray-700":"bg-white border-gray-200",A=w?"text-white":"text-gray-900",V=w?"text-gray-400":"text-gray-600";e.useEffect(()=>{F()},[]);const F=async()=>{try{M(!0);const e=localStorage.getItem("token");if(!e)return void s.error("Please login to view your apps");const i=await fetch("http://localhost:3001/api/global-marketplace/my-installed-apps",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),a=await i.json();a.success?N(a.apps):s.error("Failed to load apps")}catch(e){s.error("Failed to load apps")}finally{M(!1)}},T=e=>{const i=b.find(s=>s.app.id===e.id);if(i)return X(i.windowId),void(i.isMinimized&&U(i.windowId));const a=`window-${Date.now()}`,t={id:e.id,app:e,windowId:a,isMinimized:!1,isMaximized:!1,position:{x:100+30*b.length,y:100+30*b.length},size:{width:800,height:600},zIndex:C+1};v([...b,t]),k(C+1),s.success(`Launched ${e.name}`)},U=e=>{v(b.map(s=>s.windowId===e?{...s,isMinimized:!s.isMinimized}:s))},X=e=>{const s=C+1;v(b.map(i=>i.windowId===e?{...i,zIndex:s}:i)),k(s)},B=g.filter(e=>e.name.toLowerCase().includes($.toLowerCase())||e.description.toLowerCase().includes($.toLowerCase()));return i.jsxs("div",{className:`min-h-screen ${D} relative`,onMouseMove:e=>{if(!S)return;const s=e.clientX-P.x,i=e.clientY-P.y;v(b.map(e=>e.windowId===S?{...e,position:{x:s,y:i}}:e))},onMouseUp:()=>{L(null)},children:[i.jsxs("div",{className:"p-8 pb-24",children:[i.jsxs("div",{className:"max-w-7xl mx-auto mb-8",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:`text-4xl font-bold ${A} mb-2`,children:"ðŸ’» My Applications"}),i.jsxs("p",{className:V,children:[g.length," apps installed â€¢ ",b.length," running"]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>y("grid"),className:"p-2 rounded-lg "+("grid"===f?"bg-blue-600 text-white":`${Y} ${A}`),children:i.jsx(a,{className:"w-5 h-5"})}),i.jsx("button",{onClick:()=>y("list"),className:"p-2 rounded-lg "+("list"===f?"bg-blue-600 text-white":`${Y} ${A}`),children:i.jsx(t,{className:"w-5 h-5"})}),i.jsx("button",{onClick:F,className:`p-2 rounded-lg ${Y} ${A} hover:bg-blue-600 hover:text-white transition-colors`,children:i.jsx(l,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"relative",children:[i.jsx(n,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 ${V}`}),i.jsx("input",{type:"text",placeholder:"Search apps...",value:$,onChange:e=>z(e.target.value),className:`w-full pl-10 pr-4 py-3 ${Y} border rounded-lg ${A} focus:ring-2 focus:ring-blue-500 focus:outline-none`})]})]}),i.jsx("div",{className:"max-w-7xl mx-auto",children:I?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:`${V} mt-4`,children:"Loading apps..."})]}):0===B.length?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(o,{className:`w-16 h-16 ${V} mx-auto mb-4`}),i.jsx("p",{className:`${A} text-xl font-semibold mb-2`,children:"No apps installed"}),i.jsx("p",{className:V,children:"Visit the Marketplace to install applications"})]}):i.jsx("div",{className:`grid ${"grid"===f?"grid-cols-2 md:grid-cols-4 lg:grid-cols-6":"grid-cols-1"} gap-4`,children:B.map(e=>"grid"===f?(e=>i.jsx("div",{onClick:()=>T(e),className:`${Y} border rounded-xl p-4 cursor-pointer hover:scale-105 transition-all duration-300 hover:shadow-lg`,children:i.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[i.jsx("div",{className:"text-5xl",children:e.icon}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:`font-semibold ${A} text-sm`,children:e.name}),i.jsxs("p",{className:`text-xs ${V}`,children:["v",e.version]})]}),e.installation_type&&i.jsx("div",{className:"text-xs px-2 py-1 rounded-full "+("company"===e.installation_type?"bg-purple-500/20 text-purple-400":"bg-blue-500/20 text-blue-400"),children:"company"===e.installation_type?i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(c,{className:"w-3 h-3"}),i.jsx("span",{children:"Company"})]}):i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(d,{className:"w-3 h-3"}),i.jsx("span",{children:"Personal"})]})})]})},e.id))(e):(e=>i.jsxs("div",{onClick:()=>T(e),className:`${Y} border rounded-xl p-4 cursor-pointer hover:shadow-lg transition-all duration-300 flex items-center space-x-4`,children:[i.jsx("div",{className:"text-4xl",children:e.icon}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsx("h3",{className:`font-semibold ${A}`,children:e.name}),i.jsxs("span",{className:`text-xs ${V}`,children:["v",e.version]}),e.installation_type&&i.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+("company"===e.installation_type?"bg-purple-500/20 text-purple-400":"bg-blue-500/20 text-blue-400"),children:"company"===e.installation_type?"Company":"Personal"})]}),i.jsx("p",{className:`text-sm ${V} line-clamp-1`,children:e.description})]}),i.jsxs("button",{onClick:s=>{s.stopPropagation(),T(e)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center space-x-2",children:[i.jsx(x,{className:"w-4 h-4"}),i.jsx("span",{children:"Launch"})]})]},e.id))(e))})})]}),b.map(e=>{if(e.isMinimized)return null;const s=e.isMaximized?{position:"fixed",top:0,left:0,right:0,bottom:60,width:"100%",height:"calc(100% - 60px)",zIndex:e.zIndex}:{position:"fixed",left:e.position.x,top:e.position.y,width:e.size.width,height:e.size.height,zIndex:e.zIndex};return i.jsxs("div",{style:s,className:`${Y} border rounded-lg shadow-2xl flex flex-col overflow-hidden`,onClick:()=>X(e.windowId),children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-4 py-2 flex items-center justify-between cursor-move",onMouseDown:s=>((e,s)=>{const i=b.find(s=>s.windowId===e);i&&!i.isMaximized&&(L(e),_({x:s.clientX-i.position.x,y:s.clientY-i.position.y}),X(e))})(e.windowId,s),children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"text-2xl",children:e.app.icon}),i.jsx("span",{className:"text-white font-semibold",children:e.app.name})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:s=>{s.stopPropagation(),U(e.windowId)},className:"p-1 hover:bg-white/20 rounded transition-colors",children:i.jsx(p,{className:"w-4 h-4 text-white"})}),i.jsx("button",{onClick:s=>{var i;s.stopPropagation(),i=e.windowId,v(b.map(e=>e.windowId===i?{...e,isMaximized:!e.isMaximized}:e))},className:"p-1 hover:bg-white/20 rounded transition-colors",children:e.isMaximized?i.jsx(m,{className:"w-4 h-4 text-white"}):i.jsx(h,{className:"w-4 h-4 text-white"})}),i.jsx("button",{onClick:s=>{var i;s.stopPropagation(),i=e.windowId,v(b.filter(e=>e.windowId!==i))},className:"p-1 hover:bg-red-500 rounded transition-colors",children:i.jsx(u,{className:"w-4 h-4 text-white"})})]})]}),i.jsx("div",{className:"flex-1 overflow-auto p-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:e.app.icon}),i.jsx("h2",{className:`text-2xl font-bold ${A} mb-2`,children:e.app.name}),i.jsx("p",{className:`${V} mb-4`,children:e.app.description}),i.jsxs("div",{className:`${Y} border rounded-lg p-4 text-left`,children:[i.jsx("p",{className:`${V} text-sm mb-2`,children:"App is running..."}),i.jsxs("p",{className:`${V} text-xs`,children:["Version: ",e.app.version]}),i.jsxs("p",{className:`${V} text-xs`,children:["Category: ",e.app.category]})]})]})})]},e.windowId)}),i.jsxs("div",{className:`fixed bottom-0 left-0 right-0 ${Y} border-t px-4 py-2 flex items-center space-x-2 z-50`,children:[i.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[i.jsx(r,{className:"w-6 h-6 text-blue-500"}),b.map(e=>i.jsx("button",{onClick:()=>{e.isMinimized&&U(e.windowId),X(e.windowId)},className:`px-3 py-2 rounded-lg transition-all ${e.isMinimized?`${Y} opacity-50`:"bg-blue-600 text-white"} hover:scale-105`,children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{children:e.app.icon}),i.jsx("span",{className:"text-sm",children:e.app.name})]})},e.windowId))]}),i.jsx("div",{className:`${V} text-sm`,children:(new Date).toLocaleTimeString()})]})]})};export{w as default};
