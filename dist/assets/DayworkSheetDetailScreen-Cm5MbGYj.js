import{r as e,j as s}from"./react-core-FGHlRSau.js";import{F as t,E as a,U as r,X as l,a6 as d,aq as c,ar as n,as as o}from"./module-screens-Dy02k3Q1.js";import"./vendor-BX0gT1qP.js";import"./google-ai-BrP-uSwO.js";import"./developer-tools-B-VjJpHg.js";import"./supabase-DKHGIEFa.js";import"./axios-ei4kQ0Q2.js";import"./icon-pack-tZfEXMDa.js";import"./monaco-Bh77eHRb.js";const i=e=>{switch(e){case"Pending":return"bg-yellow-100 text-yellow-800";case"Approved":return"bg-green-100 text-green-800";case"Rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},x=({sheetId:x,project:p,goBack:m,currentUser:g,can:h})=>{const[j,b]=e.useState(null),[u,f]=e.useState(null),[y,N]=e.useState(!0);e.useEffect(()=>{(async()=>{N(!0);const[e,s]=await Promise.all([c(x),n()]);if(b(e||null),e?.approvedBy){const t=s.find(s=>s.id===e.approvedBy||s.name===e.approvedBy);f(t||null)}N(!1)})()},[x]);const v=async e=>{if(!j)return;const s=await o(j.id,e,g);s&&(b(s),"Approved"===s.status&&f(g))};if(y)return s.jsx("div",{className:"text-center p-8",children:"Loading T&M ticket details..."});if(!j)return s.jsx("div",{className:"text-center p-8 text-red-500",children:"T&M ticket not found."});const w=h("approve","dayworkSheet")&&"Pending"===j.status;return s.jsxs("div",{className:"flex flex-col h-full max-w-4xl mx-auto",children:[s.jsxs("header",{className:"bg-white p-4 flex items-center border-b mb-8",children:[s.jsx("button",{onClick:m,className:"mr-4 p-2 rounded-full hover:bg-gray-100",children:s.jsx(t,{className:"w-6 h-6 text-gray-600"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 truncate",children:["T&M Ticket: ",j.ticketNumber]}),s.jsx("p",{className:"text-sm text-gray-500",children:p.name})]})]}),s.jsxs("main",{className:"flex-grow space-y-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-md border border-gray-100 p-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"md:col-span-2 space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase mb-1",children:"Contractor"}),s.jsx("p",{className:"text-gray-800 font-semibold",children:j.contractor})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-800 mb-2",children:"Description of Work"}),s.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:j.description})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Status"}),s.jsx("p",{className:`font-bold py-1 px-2 rounded inline-block text-sm mt-1 ${i(j.status)}`,children:j.status})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase mb-1 flex items-center gap-1.5",children:[s.jsx(a,{className:"w-4 h-4"}),"Date"]}),s.jsx("p",{className:"text-gray-800 font-semibold",children:new Date(j.date).toLocaleDateString()})]}),u&&s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase mb-1 flex items-center gap-1.5",children:[s.jsx(r,{className:"w-4 h-4"}),"Approved By"]}),s.jsx("p",{className:"text-gray-800 font-semibold",children:u.name}),s.jsx("p",{className:"text-xs text-gray-500",children:j.approvedDate?new Date(j.approvedDate).toLocaleDateString():""})]})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-100 p-6",children:[s.jsx("h3",{className:"font-bold text-lg text-gray-800 mb-4",children:"Cost Breakdown"}),s.jsx("p",{className:"text-sm text-center text-gray-500 p-4 bg-gray-50 rounded-md",children:"Cost breakdown attachments (labor, equipment, materials) would be displayed here."})]})]}),w&&s.jsxs("footer",{className:"bg-white p-4 mt-8 border-t flex justify-end items-center gap-4",children:[s.jsxs("button",{onClick:()=>v("Rejected"),className:"px-6 py-3 rounded-md text-red-700 bg-red-100 hover:bg-red-200 font-bold flex items-center gap-2",children:[s.jsx(l,{className:"w-5 h-5"})," Reject"]}),s.jsxs("button",{onClick:()=>v("Approved"),className:"px-6 py-3 rounded-md bg-green-600 text-white hover:bg-green-700 font-bold flex items-center gap-2",children:[s.jsx(d,{className:"w-5 h-5"})," Approve"]})]})]})};export{x as default};
