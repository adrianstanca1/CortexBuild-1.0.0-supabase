import{j as e,r as t}from"./react-core-FGHlRSau.js";import{F as s,N as a,q as r,k as o,aM as l,aN as n,aO as i}from"./module-screens-Dy02k3Q1.js";import"./vendor-BX0gT1qP.js";import"./google-ai-BrP-uSwO.js";import"./developer-tools-B-VjJpHg.js";import"./supabase-DKHGIEFa.js";import"./axios-ei4kQ0Q2.js";import"./icon-pack-tZfEXMDa.js";import"./monaco-Bh77eHRb.js";const c=({startTime:s})=>{const[a,r]=t.useState("");return t.useEffect(()=>{const e=()=>{const e=new Date(s).getTime(),t=Date.now(),a=Math.max(0,t-e),o=Math.floor(a/36e5),l=Math.floor(a%36e5/6e4),n=Math.floor(a%6e4/1e3);r(`${String(o).padStart(2,"0")}:${String(l).padStart(2,"0")}:${String(n).padStart(2,"0")}`)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[s]),e.jsx("span",{className:"font-mono font-semibold",children:a})},d=({currentUser:d,navigateTo:m,goBack:x})=>{const[h,g]=t.useState([]),[u,b]=t.useState([]),[j,f]=t.useState([]),[p,y]=t.useState(!0);t.useEffect(()=>{(async()=>{y(!0);const[e,t,s]=await Promise.all([r(d),o(d),l(d.id)]);g(e.filter(e=>"Done"!==e.status)),b(t),f(s),y(!1)})()},[d]);const w=t.useMemo(()=>j.find(e=>null===e.endTime),[j]),N=t.useMemo(()=>{const e={};return h.forEach(t=>{e[t.projectId]||(e[t.projectId]=[]),e[t.projectId].push(t)}),e},[h]),v=async()=>{if(w)try{const e=await n(w.id);f(t=>t.map(t=>t.id===e.id?e:t))}catch(e){alert("Failed to clock out.")}};return e.jsxs("div",{className:"flex flex-col h-full max-w-4xl mx-auto",children:[e.jsxs("header",{className:"bg-white p-4 flex items-center border-b mb-8",children:[e.jsx("button",{onClick:x,className:"mr-4 p-2 rounded-full hover:bg-gray-100",children:e.jsx(s,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Live Time Entry"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Clock in and out of your tasks."})]})]}),e.jsxs("main",{className:"space-y-8",children:[p?e.jsx("p",{className:"text-center text-gray-500",children:"Loading your tasks..."}):Object.keys(N).map(t=>{const s=u.find(e=>e.id===t);return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[e.jsx("h2",{className:"p-4 border-b font-bold text-lg text-gray-800 bg-gray-50",children:s?.name||"Unknown Project"}),e.jsx("ul",{className:"divide-y divide-gray-200",children:N[t].map(t=>{const s=w?.taskId===t.id;return e.jsxs("li",{className:"p-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 transition-colors "+(s?"bg-green-50 border-l-4 border-green-500":"border-l-4 border-transparent"),children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Due: ",new Date(t.dueDate).toLocaleDateString()]})]}),s?e.jsxs("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[e.jsxs("div",{className:"text-green-800 flex-grow sm:flex-grow-0 flex items-center justify-center gap-2 p-2 bg-green-100 border border-green-300 rounded-md",children:[e.jsx(a,{className:"w-5 h-5"}),e.jsx(c,{startTime:w.startTime})]}),e.jsx("button",{onClick:v,className:"px-4 py-2 bg-red-600 text-white font-bold rounded-md hover:bg-red-700 transition-colors",children:"Clock Out"})]}):e.jsx("button",{onClick:()=>(async e=>{if(w)alert("You are already clocked in on another task. Please clock out first.");else try{const t=await i(e.id,e.projectId,d.id);f(e=>[...e,t])}catch(t){alert("Failed to clock in.")}})(t),disabled:!!w,className:"px-4 py-2 bg-blue-600 text-white font-bold rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed w-full sm:w-auto",children:"Clock In"})]},t.id)})})]},t)}),0===Object.keys(N).length&&!p&&e.jsx("div",{className:"text-center text-gray-500 p-8 bg-white rounded-lg shadow-md border",children:"You have no open tasks assigned to you."})]})]})},m=({goBack:t,title:a="Tool"})=>e.jsxs("div",{className:"flex flex-col h-full max-w-4xl mx-auto",children:[e.jsxs("header",{className:"bg-white p-4 flex items-center border-b mb-8",children:[e.jsx("button",{onClick:t,className:"mr-4 p-2 rounded-full hover:bg-gray-100",children:e.jsx(s,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a}),e.jsx("p",{className:"text-sm text-gray-500",children:"Feature Coming Soon"})]})]}),e.jsx("main",{className:"flex-grow flex items-center justify-center bg-white rounded-lg shadow-md border border-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Under Construction"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"This feature is currently in development and will be available soon."})]})})]}),x=t=>{const{title:s}=t;return"Live Time Entry"===s?e.jsx(d,{...t}):e.jsx(m,{goBack:t.goBack,title:t.title})};export{x as default};
