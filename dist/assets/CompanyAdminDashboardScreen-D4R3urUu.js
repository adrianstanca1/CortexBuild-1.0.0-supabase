import{r as e,j as s,u as t,L as r}from"./react-core-FGHlRSau.js";import{C as a,E as l}from"./developer-tools-B-VjJpHg.js";import{a5 as i,a6 as n,a7 as c,a8 as o,n as d,Q as x,t as m,a9 as h,E as g,aa as u,p as j,k as p,q as b}from"./module-screens-Dy02k3Q1.js";import{Q as v}from"./QuickActionsWidget-CUrzXUss.js";const f=({onDeepLink:t,currentUser:r})=>{const[a,l]=e.useState([]),[d,x]=e.useState(!0);e.useEffect(()=>{(async()=>{x(!0);const e=await c(r);l(e),x(!1)})()},[r]);const m=a.filter(e=>!e.read).length;return s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg border border-gray-100 h-full flex flex-col transition-all duration-300 ease-in-out hover:shadow-xl hover:-translate-y-1",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(i,{className:"w-6 h-6 text-gray-500"}),"My Inbox"]}),m>0&&s.jsx("button",{onClick:async()=>{const e=a.filter(e=>!e.read).map(e=>e.id);e.length>0&&(await o(e),l(e=>e.map(e=>({...e,read:!0}))))},className:"text-xs font-semibold text-blue-600 hover:underline",children:"Mark all as read"})]}),d?s.jsx("p",{className:"text-gray-500 text-center py-4 flex-grow flex items-center justify-center",children:"Loading notifications..."}):0===a.length?s.jsx("p",{className:"text-gray-500 text-center py-4 flex-grow flex items-center justify-center",children:"You're all caught up!"}):s.jsx("ul",{className:"space-y-2",children:a.map(e=>s.jsxs("li",{className:"flex items-start gap-4 p-3 rounded-lg transition-colors "+(e.read?"":"bg-blue-50"),children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center "+(e.read?"bg-gray-100":"bg-blue-100"),children:s.jsx(i,{className:"w-6 h-6 "+(e.read?"text-gray-400":"text-blue-600")})}),s.jsxs("div",{className:"flex-grow cursor-pointer",onClick:()=>e.link.projectId&&t(e.link.projectId,e.link.screen,e.link.params),children:[s.jsx("p",{className:"text-sm "+(e.read?"text-gray-600":"font-semibold text-gray-800"),children:e.message}),s.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:new Date(e.timestamp).toLocaleString()})]}),!e.read&&s.jsx("button",{onClick:()=>(async e=>{const s=a.find(s=>s.id===e);s&&!s.read&&(await o([e]),l(s=>s.map(s=>s.id===e?{...s,read:!0}:s)))})(e.id),title:"Mark as read",className:"p-2 -mr-1 rounded-full hover:bg-green-100 flex-shrink-0",children:s.jsx(n,{className:"w-5 h-5 text-green-600"})})]},e.id))})]})},N=({projects:e,navigateTo:t,onDeepLink:r})=>{const a=e.reduce((e,s)=>e+s.snapshot.openRFIs,0),l=e.reduce((e,s)=>e+s.snapshot.overdueTasks,0),i=({value:e,label:t,icon:r,color:a})=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(r,{className:`w-5 h-5 ${a}`}),s.jsx("span",{className:"font-bold text-gray-800",children:e}),s.jsx("span",{className:"text-sm text-gray-500",children:t})]});return s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg border border-gray-100 h-full flex flex-col transition-all duration-300 ease-in-out hover:shadow-xl hover:-translate-y-1",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"My Projects"}),s.jsxs("button",{onClick:()=>t("projects"),className:"text-sm font-semibold text-blue-600 hover:underline flex items-center gap-1",children:["View All ",s.jsx(d,{className:"w-4 h-4"})]})]}),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border flex flex-col sm:flex-row justify-around gap-4 mb-4",children:[s.jsx(i,{value:a,label:"Open RFIs",icon:x,color:"text-red-600"}),s.jsx(i,{value:l,label:"Overdue Tasks",icon:m,color:"text-amber-600"})]}),s.jsx("ul",{className:"space-y-1 flex-grow",children:e.slice(0,4).map(e=>s.jsx("li",{children:s.jsxs("button",{onClick:()=>r(e.id,"project-home",{}),className:"w-full flex items-center gap-3 p-2 rounded-lg text-left transition-colors hover:bg-gray-100",children:[s.jsx("img",{src:e.image,alt:e.name,className:"w-12 h-10 object-cover rounded-md flex-shrink-0"}),s.jsx("div",{className:"flex-grow",children:s.jsx("p",{className:"font-bold text-sm",children:e.name})}),s.jsx(d,{className:"w-5 h-5 text-gray-400"})]})},e.id))})]})]})},y=({metrics:e,trends:t})=>{const r=e=>{switch(e){case"improving":return"📈";case"declining":return"📉";default:return"➡️"}},a=e=>{switch(e){case"improving":return"text-green-600";case"declining":return"text-red-600";default:return"text-gray-600"}};return s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Smart Metrics"}),s.jsx("span",{className:"text-2xl",children:"🎯"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Active Projects"}),s.jsx("span",{className:"text-2xl",children:"🏗️"})]}),s.jsx("div",{className:"text-3xl font-bold text-blue-900",children:e.activeProjects}),s.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[e.completedProjects," completed • ",e.delayedProjects," delayed"]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border border-green-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-green-700",children:"Budget Health"}),s.jsx("span",{className:`text-xl ${a(t.budgetTrend)}`,children:r(t.budgetTrend)})]}),s.jsxs("div",{className:"text-3xl font-bold text-green-900",children:[e.budgetUtilization.toFixed(0),"%"]}),s.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["$",(e.remainingBudget/1e6).toFixed(1),"M remaining"]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Task Completion"}),s.jsx("span",{className:"text-2xl",children:"✅"})]}),s.jsxs("div",{className:"text-3xl font-bold text-purple-900",children:[e.taskCompletionRate.toFixed(0),"%"]}),s.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:[e.completedTasks," of ",e.totalTasks," tasks"]})]}),s.jsxs("div",{className:"rounded-lg p-4 border "+(l=e.overallRiskScore,l>70?"text-red-600 bg-red-50 border-red-200":l>40?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-green-600 bg-green-50 border-green-200"),children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium",children:"Overall Risk"}),s.jsx("span",{className:`text-xl ${a(t.riskTrend)}`,children:r(t.riskTrend)})]}),s.jsx("div",{className:"text-3xl font-bold",children:e.overallRiskScore.toFixed(0)}),s.jsx("div",{className:"text-xs mt-1",children:(e=>e>70?"High Risk":e>40?"Medium Risk":"Low Risk")(e.overallRiskScore)})]})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Performance Indicators"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx("span",{className:"text-xl",children:"⏱️"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-xs text-gray-600",children:"On-Time Delivery"}),s.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[e.onTimeDeliveryRate.toFixed(0),"%"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center",children:s.jsx("span",{className:"text-xl",children:"💰"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-xs text-gray-600",children:"Budget Compliance"}),s.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[e.budgetComplianceRate.toFixed(0),"%"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center",children:s.jsx("span",{className:"text-xl",children:"🚀"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-xs text-gray-600",children:"Team Productivity"}),s.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[e.teamProductivity.toFixed(0),"%"]})]})]})]})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Risk Distribution"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"High Risk"}),s.jsx("span",{className:"text-xs font-semibold text-red-600",children:e.highRiskProjects})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-red-500 h-2 rounded-full transition-all duration-300",style:{width:(e.totalProjects>0?e.highRiskProjects/e.totalProjects*100:0)+"%"}})})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Medium Risk"}),s.jsx("span",{className:"text-xs font-semibold text-yellow-600",children:e.mediumRiskProjects})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-yellow-500 h-2 rounded-full transition-all duration-300",style:{width:(e.totalProjects>0?e.mediumRiskProjects/e.totalProjects*100:0)+"%"}})})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Low Risk"}),s.jsx("span",{className:"text-xs font-semibold text-green-600",children:e.lowRiskProjects})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:(e.totalProjects>0?e.lowRiskProjects/e.totalProjects*100:0)+"%"}})})]})]})]}),s.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:e.overdueTasks}),s.jsx("div",{className:"text-xs text-gray-600",children:"Overdue Tasks"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:e.upcomingTasks}),s.jsx("div",{className:"text-xs text-gray-600",children:"Due This Week"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["$",(e.totalBudget/1e6).toFixed(1),"M"]}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Budget"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["$",(e.spentBudget/1e6).toFixed(1),"M"]}),s.jsx("div",{className:"text-xs text-gray-600",children:"Spent"})]})]})})]});var l},w=({insights:t,onNavigate:r})=>{const[a,l]=e.useState(null),i=e=>{switch(e){case"danger":return"🚨";case"warning":return"⚠️";case"success":return"✅";case"info":return"ℹ️"}},n=e=>{switch(e){case"danger":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"success":return"bg-green-50 border-green-200 text-green-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800"}},c=t.filter(e=>"high"===e.priority),o=t.filter(e=>"medium"===e.priority),d=t.filter(e=>"low"===e.priority);return s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Smart Insights"}),s.jsx("p",{className:"text-sm text-gray-600",children:"AI-powered recommendations"})]}),s.jsx("span",{className:"text-2xl",children:"🧠"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg border border-red-200",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:c.length}),s.jsx("div",{className:"text-xs text-red-700",children:"High Priority"})]}),s.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:o.length}),s.jsx("div",{className:"text-xs text-yellow-700",children:"Medium Priority"})]}),s.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg border border-green-200",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.length}),s.jsx("div",{className:"text-xs text-green-700",children:"Low Priority"})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:0===t.length?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("span",{className:"text-4xl mb-2 block",children:"🎉"}),s.jsx("p",{className:"text-gray-600",children:"No critical insights at the moment!"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"All projects are performing well."})]}):t.map(e=>{const t=a===e.projectId;return s.jsxs("div",{className:`border rounded-lg p-4 transition-all duration-200 ${n(e.type)} hover:shadow-md cursor-pointer`,onClick:()=>{return s=e.projectId,void l(a===s?null:s);var s},children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[s.jsx("span",{className:"text-2xl flex-shrink-0",children:i(e.type)}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[s.jsx("h3",{className:"font-semibold text-sm",children:e.title}),(c=e.priority,s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold border ${{high:"bg-red-100 text-red-800 border-red-300",medium:"bg-yellow-100 text-yellow-800 border-yellow-300",low:"bg-green-100 text-green-800 border-green-300"}[c]}`,children:c.toUpperCase()}))]}),s.jsx("p",{className:"text-xs font-medium mb-1",children:e.projectName}),s.jsx("p",{className:"text-sm",children:e.message})]})]}),s.jsx("button",{className:"ml-2 text-gray-500 hover:text-gray-700 transition-transform duration-200",style:{transform:t?"rotate(180deg)":"rotate(0deg)"},children:"▼"})]}),t&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-current border-opacity-20 animate-fadeIn",children:[e.prediction&&s.jsxs("div",{className:"mb-4 space-y-2",children:[s.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wide opacity-75",children:"ML Prediction"}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[s.jsxs("div",{className:"bg-white bg-opacity-50 rounded p-2",children:[s.jsx("div",{className:"font-semibold",children:"Budget"}),s.jsxs("div",{className:"text-lg font-bold",children:[e.prediction.prediction[0].toFixed(1),"%"]}),s.jsx("div",{className:"opacity-75",children:"overrun"})]}),s.jsxs("div",{className:"bg-white bg-opacity-50 rounded p-2",children:[s.jsx("div",{className:"font-semibold",children:"Timeline"}),s.jsx("div",{className:"text-lg font-bold",children:e.prediction.prediction[1].toFixed(0)}),s.jsx("div",{className:"opacity-75",children:"days delay"})]}),s.jsxs("div",{className:"bg-white bg-opacity-50 rounded p-2",children:[s.jsx("div",{className:"font-semibold",children:"Risk"}),s.jsx("div",{className:"text-lg font-bold",children:e.prediction.prediction[2].toFixed(0)}),s.jsx("div",{className:"opacity-75",children:"score"})]})]}),s.jsxs("div",{className:"text-xs opacity-75",children:["Confidence: ",e.prediction.confidence.toFixed(0),"%"]})]}),e.actionable&&e.suggestedAction&&s.jsxs("div",{className:"mb-3",children:[s.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wide opacity-75 mb-2",children:"Recommended Action"}),s.jsxs("div",{className:"bg-white bg-opacity-50 rounded p-3 text-sm",children:["💡 ",e.suggestedAction]})]}),s.jsxs("div",{className:"flex space-x-2",children:[r&&s.jsx("button",{onClick:s=>{s.stopPropagation(),r(e.projectId)},className:"flex-1 bg-white bg-opacity-80 hover:bg-opacity-100 text-current font-semibold py-2 px-4 rounded transition-all duration-200 text-sm",children:"View Project →"}),e.actionable&&s.jsx("button",{onClick:e=>{e.stopPropagation()},className:"flex-1 bg-white bg-opacity-80 hover:bg-opacity-100 text-current font-semibold py-2 px-4 rounded transition-all duration-200 text-sm",children:"Take Action"})]})]})]},e.projectId);var c})}),t.length>0&&s.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 text-center",children:s.jsxs("p",{className:"text-xs text-gray-600",children:["Showing ",t.length," insight",1!==t.length?"s":""," • Updated in real-time with ML predictions"]})})]})},k=(e,s)=>{const t=e.filter(e=>"In Progress"===e.status).length,r=e.filter(e=>"Completed"===e.status).length,a=e.filter(e=>{const s=new Date(e.endDate),t=new Date;return"In Progress"===e.status&&s<t}).length,l=s.filter(e=>"Done"===e.status).length,i=s.filter(e=>{const s=new Date(e.dueDate),t=new Date;return"Done"!==e.status&&s<t}).length,n=s.filter(e=>{const s=new Date(e.dueDate),t=new Date,r=new Date(t.getTime()+6048e5);return"Done"!==e.status&&s>=t&&s<=r}).length,c=e.reduce((e,s)=>e+s.budget,0),o=e.reduce((e,s)=>e+s.budget*(s.snapshot.budgetUtilization/100),0),d=c-o,x=c>0?o/c*100:0,m=e.length>0?(e.length-a)/e.length*100:100,h=e.length>0?e.filter(e=>e.snapshot.budgetUtilization<=100).length/e.length*100:100,g=s.length>0?l/s.length*100:0,u=(m+h+g)/3;return{totalProjects:e.length,activeProjects:t,completedProjects:r,delayedProjects:a,totalTasks:s.length,completedTasks:l,overdueTasks:i,upcomingTasks:n,totalBudget:c,spentBudget:o,remainingBudget:d,budgetUtilization:x,highRiskProjects:0,mediumRiskProjects:0,lowRiskProjects:0,overallRiskScore:0,onTimeDeliveryRate:m,budgetComplianceRate:h,taskCompletionRate:g,teamProductivity:u}},L=async(e,s,t)=>{let r=k(e,s);const a=await(async(e,s)=>{const t=h(),r=new Map;for(const l of e)try{const e=await t.predictProjectOutcome(l,s);r.set(l.id,e)}catch(a){}return r})(e,t);r=((e,s)=>{let t=0,r=0,a=0,l=0;s.forEach(e=>{const s=e.prediction[2];t+=s,s>70?r++:s>40?a++:l++});const i=s.size>0?t/s.size:0;return{...e,highRiskProjects:r,mediumRiskProjects:a,lowRiskProjects:l,overallRiskScore:i}})(r,a);const l=((e,s)=>{const t=[];return s.forEach((s,r)=>{const a=e.find(e=>e.id===r);if(!a)return;const l=s.prediction[2];l>70&&t.push({projectId:r,projectName:a.name,type:"danger",priority:"high",title:"High Risk Alert",message:`${a.name} has a ${l.toFixed(0)}% risk score. Immediate attention required.`,prediction:s,actionable:!0,suggestedAction:"Review project timeline and budget allocation"})}),e.forEach(e=>{if(e.snapshot.budgetUtilization>90){const r=s.get(e.id);t.push({projectId:e.id,projectName:e.name,type:"warning",priority:"high",title:"Budget Alert",message:`${e.name} is at ${e.snapshot.budgetUtilization.toFixed(0)}% budget utilization.`,prediction:r,actionable:!0,suggestedAction:"Review expenses and adjust budget forecast"})}}),e.forEach(e=>{const r=new Date(e.endDate),a=new Date,l=s.get(e.id);"In Progress"===e.status&&r<a&&t.push({projectId:e.id,projectName:e.name,type:"warning",priority:"medium",title:"Timeline Delay",message:`${e.name} is past its deadline.`,prediction:l,actionable:!0,suggestedAction:"Update timeline and communicate with stakeholders"})}),e.forEach(e=>{const r=s.get(e.id);if(!r)return;const a=r.prediction[2],l=e.snapshot.budgetUtilization;a<30&&l<80&&t.push({projectId:e.id,projectName:e.name,type:"success",priority:"low",title:"On Track",message:`${e.name} is performing well with low risk and good budget control.`,prediction:r,actionable:!1})}),t.sort((e,s)=>{const t={high:0,medium:1,low:2};return t[e.priority]-t[s.priority]})})(e,a),i=(e=>{let s=0,t=0,r=0,a=0;e.forEach(e=>{s+=e.prediction[0],t+=e.prediction[1],r+=e.prediction[2],a++});const l=a>0?s/a:0,i=a>0?t/a:0,n=a>0?r/a:0;return{budgetTrend:l<5?"improving":l>10?"declining":"stable",timelineTrend:i<5?"improving":i>10?"declining":"stable",riskTrend:n<40?"improving":n>60?"declining":"stable"}})(a);return{metrics:r,insights:l,predictions:a,trends:i}},M=({tasks:e,onDeepLink:t})=>{const r=e.filter(e=>"Done"!==e.status&&new Date(e.dueDate)>=new Date).sort((e,s)=>new Date(e.dueDate).getTime()-new Date(s.dueDate).getTime());return s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-100 h-full flex flex-col",children:[s.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[s.jsx(g,{className:"w-6 h-6 text-gray-500"})," Upcoming Deadlines"]}),0===r.length?s.jsx("p",{className:"text-gray-500 flex-grow flex items-center justify-center",children:"No upcoming deadlines."}):s.jsx("ul",{className:"space-y-3",children:r.slice(0,4).map(e=>s.jsxs("li",{onClick:()=>t(e.projectId,"task-detail",{taskId:e.id}),className:"p-3 bg-gray-50 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-100",children:[s.jsx("p",{className:"font-semibold text-sm text-gray-800",children:e.title}),s.jsxs("p",{className:"text-xs text-red-600 font-bold mt-1",children:["Due: ",new Date(e.dueDate).toLocaleDateString()]})]},e.id))})]})},C=({currentUser:e,navigateTo:t})=>{const{companySubscriptions:r,availableAgents:a,isLoading:l,tenantContext:i}=u(e),n=r.filter(e=>"active"===e.status),c=a.filter(e=>e.isFeatured).slice(0,3);return l&&0===r.length?s.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]})}):s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-600 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-white text-xl",children:"🤖"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI Agents"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[i?.company.name," - Multi-tenant AI Platform"]})]})]}),s.jsx("button",{onClick:()=>t("ai-agents-marketplace"),className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"View All →"})]}),n.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:["Active Subscriptions (",n.length,")"]}),s.jsxs("div",{className:"space-y-2",children:[n.slice(0,3).map(e=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-green-600 text-sm font-bold",children:e.agent?.name.charAt(0)||"A"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.agent?.name||"AI Agent"}),s.jsxs("div",{className:"text-xs text-gray-600",children:[e.agent?.category," • ",e.billingCycle]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded-full",children:"Active"}),s.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",e.pricePaid]})]})]},e.id)),n.length>3&&s.jsx("div",{className:"text-center",children:s.jsxs("button",{onClick:()=>t("ai-agents-marketplace"),className:"text-sm text-blue-600 hover:text-blue-700",children:["+",n.length-3," more subscriptions"]})})]})]}),0===n.length&&c.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Featured AI Agents"}),s.jsx("div",{className:"space-y-2",children:c.map(e=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors cursor-pointer",onClick:()=>t("ai-agents-marketplace"),children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-blue-600 text-sm font-bold",children:e.name.charAt(0)})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),s.jsxs("div",{className:"text-xs text-gray-600",children:[e.category," • $",e.priceMonthly,"/mo"]})]})]}),s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx("span",{className:"text-xs text-yellow-600 bg-yellow-100 px-2 py-1 rounded-full",children:"⭐ Featured"})})]},e.id))})]}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Company:"})," ",i?.company.name]}),s.jsxs("div",{className:"text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Available:"})," ",a.length," agents"]})]}),s.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-4 text-center",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[s.jsx("div",{className:"text-lg font-bold text-gray-900",children:n.length}),s.jsx("div",{className:"text-xs text-gray-600",children:"Active"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[s.jsx("div",{className:"text-lg font-bold text-gray-900",children:a.length}),s.jsx("div",{className:"text-xs text-gray-600",children:"Available"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[s.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["$",n.reduce((e,s)=>e+s.pricePaid,0).toFixed(0)]}),s.jsx("div",{className:"text-xs text-gray-600",children:"Monthly"})]})]})]}),0===n.length&&s.jsx("div",{className:"mt-4 text-center",children:s.jsx("button",{onClick:()=>t("ai-agents-marketplace"),className:"w-full bg-gradient-to-r from-purple-500 to-blue-600 text-white py-2 px-4 rounded-lg hover:from-purple-600 hover:to-blue-700 transition-all text-sm font-medium",children:"Explore AI Agents Marketplace"})})]})},P=t=>{const{currentUser:r,navigateTo:a,onDeepLink:l,onQuickAction:i,onSuggestAction:n,selectProject:c}=t,[o,d]=e.useState([]),[x,m]=e.useState([]),[h,g]=e.useState(null),[u,k]=e.useState(!0);e.useEffect(()=>{(async()=>{k(!0);try{const[e,s]=await Promise.all([p(r),b(r)]);d(e),m(s);const t=await L(e,s,r);g(t)}catch(e){}finally{k(!1)}})(),j(r)},[r]);return u?s.jsxs("div",{className:"space-y-8 animate-pulse",children:[s.jsxs("header",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200"})]}),s.jsx("div",{className:"h-24 bg-gray-200 rounded-lg"}),s.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[s.jsx("div",{className:"h-64 bg-gray-200 rounded-lg"}),s.jsx("div",{className:"h-48 bg-gray-200 rounded-lg"})]}),s.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[s.jsx("div",{className:"h-72 bg-gray-200 rounded-lg"}),s.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"})]})]})]}):s.jsxs("div",{className:"space-y-8",children:[s.jsxs("header",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Company Dashboard"}),s.jsxs("p",{className:"text-md text-gray-500",children:["Welcome, ",r.name,"! 🚀"]})]}),s.jsx("img",{src:r.avatar,alt:"User Avatar",className:"w-12 h-12 rounded-full shadow-lg border-2 border-blue-200"})]}),h&&s.jsx(y,{metrics:h.metrics,trends:h.trends}),s.jsx(v,{onQuickAction:i,onSuggestAction:n,isGlobal:!0,currentUser:r}),s.jsxs("main",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[h&&s.jsx(w,{insights:h.insights,onNavigate:e=>{c(e),a("project-detail")}}),s.jsx(N,{projects:o,navigateTo:a,onDeepLink:l}),s.jsx(M,{tasks:x,onDeepLink:l})]}),s.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[s.jsx(C,{currentUser:r,navigateTo:a}),s.jsx(f,{currentUser:r,onDeepLink:l})]})]})]})},A=e.createContext(null),T=()=>{const a=t(),l=(()=>{const s=e.useContext(A);if(!s)throw new Error("useTenant must be used within TenantProvider");return s})().user,i=[{name:"Dashboard",path:"/dashboard",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{name:"Projects",path:"/projects",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})},{name:"Team",path:"/team",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{name:"RFIs",path:"/rfis",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},{name:"Punch Lists",path:"/punch-lists",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})},{name:"Daily Logs",path:"/daily-logs",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})},{name:"Documents",path:"/documents",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{name:"Drawings",path:"/drawings",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})},{name:"Time Tracking",path:"/time-tracking",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})},{name:"Delivery",path:"/delivery",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})})},{name:"Reports",path:"/reports",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{name:"AI Agents",path:"/agents",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})},{name:"ML Analytics",path:"/ml-analytics",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})})},{name:"Platform Admin",path:"/platform-admin",icon:s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),roles:["super_admin"]}];return s.jsxs("div",{className:"flex flex-col h-screen w-64 bg-white border-r border-gray-200 fixed left-0 top-0",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-lg",children:"🏗️"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"ConstructAI"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Powered by AI"})]})]})}),s.jsxs("nav",{className:"flex-1 overflow-y-auto p-4",children:[s.jsx("p",{className:"px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3",children:"Navigation"}),s.jsx("ul",{className:"space-y-1",children:i.filter(e=>!e.roles||l&&e.roles.includes(l.role)).map(e=>{return s.jsx("li",{children:s.jsxs(r,{to:e.path,className:"flex items-center gap-3 px-3 py-2 rounded-lg transition-colors "+(t=e.path,a.pathname===t||a.pathname.startsWith(t+"/")?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-50"),children:[e.icon,s.jsx("span",{className:"text-sm",children:e.name})]})},e.path);var t})})]}),l&&s.jsx("div",{className:"p-4 border-t border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-semibold text-sm",children:(n=l.name||l.email,n.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2))})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:l.name||"User"}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:l.email})]})]})})]});var n},D=({children:e})=>s.jsxs("div",{className:"flex h-screen bg-gray-50",children:[s.jsx(T,{}),s.jsx("main",{className:"flex-1 ml-64 overflow-y-auto",children:s.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e})})]}),B=({icon:e,title:t,value:r,subtitle:l,trend:i,color:n="blue",onClick:c})=>s.jsx(a,{hover:!!c,onClick:c,className:"relative overflow-hidden",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:t}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 mb-1",children:r}),l&&s.jsx("p",{className:"text-sm text-gray-500",children:l}),i&&s.jsx("div",{className:"flex items-center mt-2",children:s.jsxs("span",{className:"text-sm font-medium "+(i.isPositive?"text-green-600":"text-red-600"),children:[i.isPositive?"↗":"↘"," ",i.value]})})]}),s.jsx("div",{className:`p-3 rounded-lg ${{blue:"text-blue-600 bg-blue-50",green:"text-green-600 bg-green-50",yellow:"text-yellow-600 bg-yellow-50",red:"text-red-600 bg-red-50",purple:"text-purple-600 bg-purple-50"}[n]}`,children:e})]})}),R=({status:e,label:t,size:r="md"})=>{const a={in_progress:{bg:"bg-blue-100",text:"text-blue-700",label:"In Progress"},planning:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Planning"},completed:{bg:"bg-green-100",text:"text-green-700",label:"Completed"},on_hold:{bg:"bg-gray-100",text:"text-gray-700",label:"On Hold"},cancelled:{bg:"bg-red-100",text:"text-red-700",label:"Cancelled"},approved:{bg:"bg-green-100",text:"text-green-700",label:"Approved"},pending:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Pending"},active:{bg:"bg-blue-100",text:"text-blue-700",label:"Active"},inactive:{bg:"bg-gray-100",text:"text-gray-700",label:"Inactive"}}[e],l=t||a.label;return s.jsx("span",{className:`inline-flex items-center rounded-full font-medium ${a.bg} ${a.text} ${{sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-sm",lg:"px-3 py-1.5 text-base"}[r]}`,children:l})},I=({project:e,onClick:t,showAction:r=!0})=>{return s.jsx(a,{hover:!0,padding:"md",onClick:t,children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.name}),s.jsx(R,{status:e.status,size:"sm"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.client&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:e.client}),e.budget&&s.jsx("span",{children:"•"})]}),e.budget&&s.jsxs(s.Fragment,{children:[s.jsxs("span",{children:["Budget: ",(l=e.budget,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(l))]}),void 0!==e.progress&&s.jsx("span",{children:"•"})]}),void 0!==e.progress&&s.jsxs("span",{children:[e.progress,"% complete"]})]})]}),r&&s.jsx("button",{type:"button",className:"ml-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",onClick:e=>{e.stopPropagation(),t?.()},children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})});var l},W=({icon:e,title:t,description:r,actionLabel:l,onAction:i,variant:n="info"})=>{const c={info:{iconBg:"bg-blue-100",iconText:"text-blue-600",button:"bg-blue-600 hover:bg-blue-700 text-white"},warning:{iconBg:"bg-yellow-100",iconText:"text-yellow-600",button:"bg-yellow-600 hover:bg-yellow-700 text-white"},success:{iconBg:"bg-green-100",iconText:"text-green-600",button:"bg-green-600 hover:bg-green-700 text-white"},danger:{iconBg:"bg-red-100",iconText:"text-red-600",button:"bg-red-600 hover:bg-red-700 text-white"}}[n];return s.jsx(a,{padding:"md",children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${c.iconBg} ${c.iconText}`,children:e}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 flex-1",children:t})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4 flex-1",children:r}),s.jsx("button",{type:"button",onClick:i,className:`w-full px-4 py-2 rounded-lg font-medium transition-colors ${c.button}`,children:l})]})})},z=({icon:e,title:t,description:r,variant:a="info",onClick:l})=>{const i={info:{bg:"bg-blue-50",iconBg:"bg-blue-100",iconText:"text-blue-600",titleText:"text-blue-900",descText:"text-blue-700"},warning:{bg:"bg-yellow-50",iconBg:"bg-yellow-100",iconText:"text-yellow-600",titleText:"text-yellow-900",descText:"text-yellow-700"},success:{bg:"bg-green-50",iconBg:"bg-green-100",iconText:"text-green-600",titleText:"text-green-900",descText:"text-green-700"},danger:{bg:"bg-red-50",iconBg:"bg-red-100",iconText:"text-red-600",titleText:"text-red-900",descText:"text-red-700"}}[a];return s.jsx("div",{className:`p-4 rounded-lg ${i.bg} ${l?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:l,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${i.iconBg} ${i.iconText} flex-shrink-0`,children:e}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:`text-sm font-semibold ${i.titleText} mb-1`,children:t}),s.jsx("p",{className:`text-sm ${i.descText}`,children:r})]})]})})},$=t=>{const{currentUser:r,navigateTo:l,onDeepLink:i,onQuickAction:n,onSuggestAction:c,selectProject:o}=t,[d,x]=e.useState([]),[m,h]=e.useState([]),[g,u]=e.useState(null),[v,f]=e.useState(!0);e.useEffect(()=>{(async()=>{f(!0);try{const[e,s]=await Promise.all([p(r),b(r)]);x(e),h(s);const t=await L(e,s,r);u(t)}catch(e){}finally{f(!1)}})(),j(r)},[r]);const N=e=>{o(e),l("project-detail")};if(v)return s.jsx(D,{children:s.jsxs("div",{className:"space-y-6 animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),s.jsx("div",{className:"grid grid-cols-4 gap-6",children:[1,2,3,4].map(e=>s.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},e))}),s.jsx("div",{className:"h-64 bg-gray-200 rounded-lg"})]})});const y=d.filter(e=>"in_progress"===e.status).length,w=d.reduce((e,s)=>e+(s.budget||0),0),k=d.length>0?Math.round(d.filter(e=>"completed"===e.status).length/d.length*100):0;return s.jsx(D,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Welcome back, ",r.name?.split(" ")[0]||"User"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Here's what's happening with your construction projects today"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsx(B,{icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),title:"Active Projects",value:y,subtitle:`of ${d.length} total`,color:"blue",onClick:()=>l("projects")}),s.jsx(B,{icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),title:"Total Revenue",value:`$${(w/1e6).toFixed(1)}M`,trend:g?.trends?.revenue?{value:`${g.trends.revenue}% vs last month`,isPositive:g.trends.revenue>0}:void 0,color:"green"}),s.jsx(B,{icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),title:"Alerts",value:g?.insights?.length||0,subtitle:"Needs attention",color:"yellow"}),s.jsx(B,{icon:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),title:"Completion Rate",value:`${k}%`,subtitle:"Projects on track",color:"purple"})]}),g&&g.insights&&g.insights.length>0&&s.jsxs(a,{padding:"md",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI Business Insights"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:g.insights.slice(0,3).map((e,t)=>s.jsx(W,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),title:e.title,description:e.description,actionLabel:e.action||"View Details",variant:"high"===e.priority?"warning":"info",onAction:()=>{e.projectId&&N(e.projectId)}},t))})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Projects"})]}),s.jsx("button",{type:"button",onClick:()=>l("projects"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All →"})]}),s.jsx("div",{className:"space-y-3",children:d.slice(0,5).map(e=>s.jsx(I,{project:{id:e.id,name:e.name,status:e.status,client:e.client,budget:e.budget,progress:e.progress},onClick:()=>N(e.id)},e.id))})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(a,{padding:"md",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Alerts & Actions"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(z,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),title:"Outstanding Invoices",description:"$1,036,800 awaiting payment",variant:"warning"}),s.jsx(z,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),title:"AI Recommendation",description:"Schedule weekly project reviews to stay on track",variant:"info"})]})]}),s.jsxs(a,{padding:"md",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("button",{type:"button",onClick:()=>n("projects"),className:"w-full flex items-center gap-3 px-4 py-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors text-left",children:[s.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"New Project"})]}),s.jsxs("button",{type:"button",onClick:()=>l("agents"),className:"w-full flex items-center gap-3 px-4 py-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors text-left",children:[s.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-sm font-medium text-purple-900",children:"Browse AI Agents"})]})]})]})]})]})})},S={executive:"Executive Overview",operations:"Operational Control",legacy:"Legacy Widgets"},V=t=>{const{currentUser:r}=t,[a,i]=e.useState("executive"),n=e.useMemo(()=>{switch(a){case"operations":return s.jsx($,{...t});case"legacy":return s.jsx(P,{...t});default:return s.jsx(l,{})}},[a,t]);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("header",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Company Admin Workspace"}),s.jsxs("p",{className:"text-sm text-slate-600",children:["Welcome back, ",r.name.split(" ")[0]||r.email,"! Choose the dashboard best suited for today's priorities."]})]}),s.jsx("div",{className:"inline-flex items-center rounded-lg border border-slate-200 bg-white p-1 shadow-sm",children:Object.keys(S).map(e=>s.jsx("button",{type:"button",onClick:()=>i(e),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-colors "+(a===e?"bg-blue-600 text-white shadow":"text-slate-600 hover:bg-slate-100"),children:S[e]},e))})]}),s.jsx("section",{children:n})]})},F=Object.freeze(Object.defineProperty({__proto__:null,default:V},Symbol.toStringTag,{value:"Module"}));export{V as C,f as N,N as P,y as S,w as a,F as b,k as c,L as p};
