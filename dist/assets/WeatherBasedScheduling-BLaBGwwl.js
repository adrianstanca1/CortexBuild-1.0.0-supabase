import{r as e,j as s}from"./react-core-FGHlRSau.js";import{s as t}from"./developer-tools-B-VjJpHg.js";import{at as a,e as r,ac as l,b as d,Z as i,av as c,au as n,bA as x,as as m}from"./icon-pack-tZfEXMDa.js";import"./vendor-BX0gT1qP.js";import"./supabase-DKHGIEFa.js";import"./axios-ei4kQ0Q2.js";import"./monaco-Bh77eHRb.js";const o=({currentUser:o,goBack:h})=>{const[j,g]=e.useState([]),[p,b]=e.useState([]);e.useEffect(()=>{(async()=>{if(g([]),!t)return void b([]);const{data:e}=await t.from("tasks").select("id, title, project:projects(name), schedule_status, weather_sensitive, created_at").eq("weather_sensitive",!0).order("created_at",{ascending:!0}).limit(50),s=(e||[]).map(e=>({id:e.id,name:e.title,project:e.project?.name||"Project",scheduledDate:new Date(e.created_at),weatherDependent:!!e.weather_sensitive,riskLevel:"high",alternative:"review_pending"===e.schedule_status?"Reschedule pending":void 0}));b(s)})()},[]);const N=e=>{const t={sunny:s.jsx(m,{className:"h-8 w-8 text-yellow-500"}),cloudy:s.jsx(a,{className:"h-8 w-8 text-gray-500"}),rainy:s.jsx(n,{className:"h-8 w-8 text-blue-500"}),stormy:s.jsx(n,{className:"h-8 w-8 text-purple-500"}),snowy:s.jsx(x,{className:"h-8 w-8 text-cyan-500"})};return t[e]||t.cloudy},v=j.filter(e=>e.workable).length,u=j.reduce((e,s)=>e+s.impactedTasks,0);return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(a,{className:"h-8 w-8 text-blue-600"}),s.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Weather-Based Scheduling"}),s.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-sm font-bold rounded-full",children:"INDUSTRY FIRST"})]}),s.jsx("p",{className:"text-gray-600 text-lg",children:"AI-powered scheduling that adapts to weather conditions automatically"})]}),u>0&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-6 rounded-lg mb-8",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(r,{className:"h-6 w-6 text-red-600 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-red-900 mb-1",children:"Weather Alert!"}),s.jsxs("p",{className:"text-red-800",children:[u," weather-dependent tasks may be affected in the next 5 days. AI has suggested alternatives below."]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx(l,{className:"h-8 w-8 text-blue-600"}),s.jsx("span",{className:"text-3xl font-bold text-gray-900",children:v})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Workable Days (Next 5)"}),s.jsxs("div",{className:"mt-2 flex items-center gap-1 text-sm text-green-600",children:[s.jsx(d,{className:"h-4 w-4"}),s.jsx("span",{children:"Good conditions"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx(r,{className:"h-8 w-8 text-orange-600"}),s.jsx("span",{className:"text-3xl font-bold text-gray-900",children:u})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Impacted Tasks"}),s.jsxs("div",{className:"mt-2 flex items-center gap-1 text-sm text-orange-600",children:[s.jsx(r,{className:"h-4 w-4"}),s.jsx("span",{children:"Needs rescheduling"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx(i,{className:"h-8 w-8 text-purple-600"}),s.jsx("span",{className:"text-3xl font-bold text-gray-900",children:"Auto"})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"AI Optimization"}),s.jsxs("div",{className:"mt-2 flex items-center gap-1 text-sm text-purple-600",children:[s.jsx(i,{className:"h-4 w-4"}),s.jsx("span",{children:"Enabled"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 mb-8",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"5-Day Weather Forecast"})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 divide-x divide-gray-200",children:j.map((e,t)=>s.jsx("div",{className:`p-6 ${e.workable?"":"bg-red-50"} hover:bg-gray-50 transition-colors`,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-sm font-medium text-gray-600 mb-2",children:e.date.toLocaleDateString("en-US",{weekday:"short"})}),s.jsx("div",{className:"flex justify-center mb-3",children:N(e.condition)}),s.jsxs("div",{className:"text-2xl font-bold text-gray-900 mb-1",children:[e.temp,"Â°C"]}),s.jsx("div",{className:"text-sm text-gray-600 mb-3 capitalize",children:e.condition}),s.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s.jsx(c,{className:"h-3 w-3"}),e.windSpeed," km/h"]}),s.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s.jsx(n,{className:"h-3 w-3"}),e.precipitation,"%"]})]}),!e.workable&&s.jsx("div",{className:"mt-3 px-2 py-1 bg-red-100 text-red-800 text-xs font-semibold rounded-full",children:"Not Workable"}),e.impactedTasks>0&&s.jsxs("div",{className:"mt-2 text-xs text-red-600 font-medium",children:[e.impactedTasks," tasks affected"]})]})},t))})]}),p.length>0&&s.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Weather-Dependent Tasks"})}),s.jsx("div",{className:"divide-y divide-gray-200",children:p.map(e=>s.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:e.name}),s.jsxs("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold "+("high"===e.riskLevel?"bg-red-100 text-red-800":"medium"===e.riskLevel?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:[e.riskLevel," risk"]})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.project}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(l,{className:"h-4 w-4"}),e.scheduledDate.toLocaleDateString()]}),e.alternative&&s.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[s.jsx(i,{className:"h-4 w-4"}),"AI Suggestion: ",e.alternative]})]})]}),s.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:"Reschedule"})]})},e.id))})]})]})})};export{o as WeatherBasedScheduling};
